
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Feature Extraction Methods for Images &#8212; Fire Detection in Images</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Features_extraction_methods';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Applying inner evaluation" href="Inner_evaluation.html" />
    <link rel="prev" title="Filtering Images" href="Filtering_images.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.jpg" class="logo__image only-light" alt="Fire Detection in Images - Home"/>
    <script>document.write(`<img src="_static/logo.jpg" class="logo__image only-dark" alt="Fire Detection in Images - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Fire Detection in Images
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="images_processing.html"><strong>Images Processing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Filtering_images.html"><strong>Filtering Images</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Feature Extraction Methods for Images</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Inner_evaluation.html"><strong>Applying inner evaluation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Selecting_best_pipeline.html"><strong>Selecting the best pipeline</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Outer_evaluation.html"><strong>Applying Outer Evaluation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Predicting_new_data.html"><strong>Predicting New Images</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FabioScielzoOrtiz/Fire-Detection" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FabioScielzoOrtiz/Fire-Detection/issues/new?title=Issue%20on%20page%20%2FFeatures_extraction_methods.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Features_extraction_methods.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Feature Extraction Methods for Images</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements"><strong>Requirements</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-the-data"><strong>Reading the data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-response-and-predictors"><strong>Defining Response and Predictors</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-method"><strong>Pixel Method</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-pixel-features-from-gray-scale-image"><strong>Extracting pixel features from gray-scale image</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-pixel-features-from-color-image"><strong>Extracting pixel features from color image</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-features-array"><strong>Pixel features array</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-data-features-tensor"><strong>Sequential data: features tensor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabular-data-features-matrix"><strong>Tabular data: features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorial-representation-of-an-image"><strong>Vectorial representation of an image</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-matrix-for-gray-scale-images"><strong>Getting pixels features matrix for gray-scale images</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-matrix-for-color-images"><strong>Getting pixels features matrix for color images</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-tensor-for-gray-scale-images"><strong>Getting pixels features tensor for gray-scale images</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-tensor-for-color-images"><strong>Getting pixels features tensor for color images</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-of-oriented-gradients-method"><strong>Histogram of Oriented Gradients Method</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#based-on-statistics"><strong>Based on Statistics</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#based-on-bags-of-visual-words-bvw"><strong>Based on Bags of Visual Words (BVW)</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hog-stats-features-matrix"><strong>HOG-stats features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-hgo-stats-features-matrix"><strong>Getting HGO-stats features matrix</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hog-bvw-features-matrix"><strong>HOG-BVW features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-hgo-bvw-features-matrix"><strong>Getting HGO-BVW features matrix</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hog-not-reshaped-features-matrix"><strong>HOG - Not Reshaped features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-hgo-not-reshaped-features-matrix"><strong>Getting HGO - Not Reshaped features matrix</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convolutional-neural-networks-method"><strong>Convolutional Neural Networks Method</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cnn-features-matrix"><strong>CNN features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-cnn-features-matrix"><strong>Getting CNN features matrix</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="feature-extraction-methods-for-images">
<h1><strong>Feature Extraction Methods for Images</strong><a class="headerlink" href="#feature-extraction-methods-for-images" title="Link to this heading">#</a></h1>
<p>The basic idea of feature extraction methods applied to images is to convert raw image data into a numerical representation, typically an array or a set of numerical descriptors. This numerical representation captures important characteristics or features of the image, making it amenable to analysis by machine learning algorithms and statistical techniques.</p>
<p>Feature extraction serves as a bridge between the raw visual content of an image and the mathematical models used in computer vision tasks. By extracting relevant features from images, we can abstract away unnecessary details while retaining essential information that is crucial for the task at hand.</p>
<p>There exist numerous feature extraction methods tailored to different types of image data and tasks. Among them, some standard techniques are commonly employed in image processing pipelines. These methods often include:</p>
<ul class="simple">
<li><p><strong>Pixel Intensity:</strong> A straightforward approach involves using the pixel intensity values directly as features. In grayscale images, each pixel’s intensity represents a feature, while in color images, features may include intensity values from different color channels (e.g., Red, Green, Blue).
Histogram-based Features: Histograms provide a compact representation of the distribution of pixel intensities in an image. Histogram-based features capture statistical information about the image’s brightness, contrast, and color distribution. Common histogram features include mean, variance, skewness, and kurtosis.</p></li>
<li><p><strong>Texture Features:</strong> Texture refers to the spatial arrangement of pixels in an image and their variations in intensity or color. Texture features describe patterns, structures, and regularities present in different regions of the image. Techniques such as co-occurrence matrices, local binary patterns (LBP), and Gabor filters are commonly used for texture feature extraction.</p></li>
<li><p><strong>Edge and Contour Features:</strong> Edges represent abrupt changes in pixel intensity and often correspond to object boundaries or significant image structures. Edge detection algorithms extract features based on the presence, orientation, and strength of edges in the image. Contour-based features describe the shape, curvature, and spatial arrangement of object boundaries.</p></li>
<li><p><strong>Transform-based Features:</strong> Transform-based methods, such as Fourier transform, wavelet transform, and principal component analysis (PCA), extract features by analyzing the frequency, spatial, or spectral characteristics of the image. These methods help capture global and local image patterns efficiently.</p></li>
</ul>
<section id="requirements">
<h2><strong>Requirements</strong><a class="headerlink" href="#requirements" title="Link to this heading">#</a></h2>
<p>Here we gather the required libraries, classes and function for this notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">polars</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;whitegrid&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">from</span> <span class="nn">keras.applications.vgg16</span> <span class="kn">import</span> <span class="n">preprocess_input</span>
<span class="kn">from</span> <span class="nn">keras.applications.vgg16</span> <span class="kn">import</span> <span class="n">VGG16</span> 
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Model</span>
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> is a Python package that has been developed under this project, which has several utils for plotting images and extracting features from them, features that later could be used along with Machine Learning algorithms to solve typical ML tasks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;C:\Users\fscielzo\Documents\Packages\PyImageML_Package_Private&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">PyImageML.preprocessing</span> <span class="kn">import</span> <span class="n">ImageFeaturesExtraction</span><span class="p">,</span> <span class="n">ImageTensorFeaturesExtraction</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reading-the-data">
<h2><strong>Reading the data</strong><a class="headerlink" href="#reading-the-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extracting the names of the images files as well as their class/category.</span>
<span class="n">files_list_name</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\fscielzo\Documents\DataScience-GitHub\Image Analysis\Image-Classification\Fire-Detection\files_list.txt&#39;</span>
<span class="n">files_df</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">files_list_name</span><span class="p">,</span> <span class="n">separator</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">has_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">new_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">])</span>
<span class="n">img_files_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">files_df</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files_df</span><span class="p">))]</span>

<span class="c1"># building a list with the current paths of the data-set images.</span>
<span class="n">img_path_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">folder_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;C:\Users\fscielzo\Documents\DataScience-GitHub\Image Analysis\Image-Classification\Fire-Detection\Data&#39;</span>
<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">img_files_names</span><span class="p">:</span>
    <span class="n">img_path_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder_path</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="defining-response-and-predictors">
<h2><strong>Defining Response and Predictors</strong><a class="headerlink" href="#defining-response-and-predictors" title="Link to this heading">#</a></h2>
<p>In this section we define the response and predictors.</p>
<ul class="simple">
<li><p><strong>Predictors:</strong> a list with the paths of the images files.</p></li>
<li><p><strong>Response:</strong> a vector (1D array) that identify the category of each image.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">files_df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">img_path_list</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="pixel-method">
<h2><strong>Pixel Method</strong><a class="headerlink" href="#pixel-method" title="Link to this heading">#</a></h2>
<p>Given and image <span class="math notranslate nohighlight">\(\mathcal{I}\)</span> of height <span class="math notranslate nohighlight">\(h\)</span> and wight <span class="math notranslate nohighlight">\(w\)</span>, we have a different pixels representation of the image depending on whether it is color-scale or gray-scale.</p>
<p>In the Pixels method for extracting features on images the following points are crucial:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{I}\)</span> is defined by its pixels.</p></li>
</ul>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{I}\)</span> has <span class="math notranslate nohighlight">\(h\cdot w\)</span> pixels.</p></li>
</ul>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mathcal{I}\)</span> can be represented as an 2D array (matrix) of pixels, where each element/position is a pixel.</p>
<div class="math notranslate nohighlight">
\[\begin{split}M(\mathcal{I}) = \begin{pmatrix} p_{1,1} &amp; p_{1,2} &amp;\dots &amp; p_{1,w}  \\
                                   p_{2,1} &amp; p_{2,2} &amp; \dots &amp; p_{2,w} \\
                                   \dots  &amp; \dots &amp; \dots \\
                                   p_{h,1} &amp; p_{h,2} &amp; \dots &amp; p_{h,w}
                   \end{pmatrix} = \left( p_{ij}\right)_{\substack{i=1,..,h \\ j=1,..,w}}\end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(p_{ij}\)</span> is the pixel of <span class="math notranslate nohighlight">\(\mathcal{I}\)</span> that occupies position <span class="math notranslate nohighlight">\((i,j)\)</span> in the image, namely, the pixel <span class="math notranslate nohighlight">\((i,j)\)</span>.</p>
</li>
</ul>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(\mathcal{I}\)</span> is <strong>gray</strong>-scale:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p_{ij} \in [0,255] \subset \mathbb{Z}\\[0.5cm]\end{split}\]</div>
<ul class="simple">
<li><p>The closer <span class="math notranslate nohighlight">\(p_{ij}\)</span> to <span class="math notranslate nohighlight">\(0\)</span>, the <strong>lower</strong> the <strong>gray</strong> intensity of the pixel.</p></li>
<li><p>The closer <span class="math notranslate nohighlight">\(p_{ij}\)</span> to <span class="math notranslate nohighlight">\(255\)</span>, the <strong>greater</strong> the <strong>gray</strong> intensity of the pixel.</p></li>
</ul>
</li>
</ul>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(\mathcal{I}\)</span> is <strong>color</strong>-scale:</p>
<div class="math notranslate nohighlight">
\[p_{ij} = (R_{ij}, G_{ij}, B_{ij})\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R_{ij}, G_{ij}, B_{ij} \in [0,255] \subset \mathbb{Z}\)</span> are the red, green and blue channels, respectively, that is, the red, green and blue part of the pixel <span class="math notranslate nohighlight">\(p_{ij}\)</span>.</p></li>
<li><p>The closer <span class="math notranslate nohighlight">\(R_{ij}, G_{ij}, B_{ij}\)</span> to <span class="math notranslate nohighlight">\(0\)</span>, the <strong>lower</strong> the <strong>red</strong>, <strong>green</strong>, <strong>blue</strong> intensity of the pixel, respectively.</p></li>
<li><p>The closer <span class="math notranslate nohighlight">\(R_{ij}, G_{ij}, B_{ij}\)</span> to <span class="math notranslate nohighlight">\(255\)</span>, the <strong>greater</strong> the <strong>red</strong>,<strong>green</strong>, <strong>blue</strong> intensity of the pixel, respectively.</p></li>
</ul>
</li>
</ul>
<section id="extracting-pixel-features-from-gray-scale-image">
<h3><strong>Extracting pixel features from gray-scale image</strong><a class="headerlink" href="#extracting-pixel-features-from-gray-scale-image" title="Link to this heading">#</a></h3>
<p>When <span class="math notranslate nohighlight">\(\mathcal{I}\)</span> is gray-scale, there are no differences with the previous approach.</p>
<p><code class="docutils literal notranslate"><span class="pre">Python</span></code> gives us <span class="math notranslate nohighlight">\(M(\mathcal{I})\)</span> directly as a 2D <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">img_path_list</span> 
<span class="n">example_img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">example_img_gray</span> <span class="o">=</span> <span class="n">example_img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">)</span>
<span class="n">example_img_gray</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9ed0a4c765d5a7e7503ecda43e2c1c8952cd22f04177d86fabf6b601c7e99568.png" src="_images/9ed0a4c765d5a7e7503ecda43e2c1c8952cd22f04177d86fabf6b601c7e99568.png" />
</div>
</div>
<ul>
<li><p><strong>Building the pixels matrix for a gray-scale image: <span class="math notranslate nohighlight">\(M(\mathcal{I})\)</span></strong></p>
<p><span class="math notranslate nohighlight">\(M(\mathcal{I}) = \)</span> <code class="docutils literal notranslate"><span class="pre">np.array(example_img_gray)</span></code></p>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_gray_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">example_img_gray</span><span class="p">)</span>
<span class="n">img_gray_array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 48,  87, 112, ..., 251, 252, 252],
       [ 33,  71,  53, ..., 252, 252, 252],
       [ 94, 105, 140, ..., 251, 252, 253],
       ...,
       [107, 102,  98, ..., 109, 108, 106],
       [102, 106, 109, ..., 119, 112, 109],
       [108, 107, 105, ..., 135, 122, 117]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(p_{12} =\)</span> <code class="docutils literal notranslate"><span class="pre">img_gray_array[0,1]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_gray_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(p_{40, 12} =\)</span> <code class="docutils literal notranslate"><span class="pre">img_gray_array[39,11]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_gray_array</span><span class="p">[</span><span class="mi">39</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>62
</pre></div>
</div>
</div>
</div>
<p><strong>Plotting the array as an image</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_gray_array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Hide the axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5af423cb23969bb6a30a6eca85e4f0028f5c1ed99291798a9943b4ff50f8baa8.png" src="_images/5af423cb23969bb6a30a6eca85e4f0028f5c1ed99291798a9943b4ff50f8baa8.png" />
</div>
</div>
</section>
<section id="extracting-pixel-features-from-color-image">
<h3><strong>Extracting pixel features from color image</strong><a class="headerlink" href="#extracting-pixel-features-from-color-image" title="Link to this heading">#</a></h3>
<p>When <span class="math notranslate nohighlight">\(\mathcal{I}\)</span> is color-scale, there are slightly differences with the previous approach.</p>
<p><code class="docutils literal notranslate"><span class="pre">Python</span></code> doesnt give us <span class="math notranslate nohighlight">\(M(\mathcal{I})\)</span> directly, but we can access to their elements by mean of a 3D array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">example_img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8959eb06acdb9ebf1131b4fb45bbc61e11136c60d3af9a42432c45283fc86c05.png" src="_images/8959eb06acdb9ebf1131b4fb45bbc61e11136c60d3af9a42432c45283fc86c05.png" />
</div>
</div>
<p>That 3D array is obtained with <code class="docutils literal notranslate"><span class="pre">np.array(example_img)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_color_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">example_img</span><span class="p">)</span>
<span class="n">img_color_array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 17,  73,   0],
        [ 58, 111,  39],
        [ 84, 136,  64],
        ...,
        [253, 250, 255],
        [254, 251, 255],
        [254, 250, 255]],

       [[  0,  57,   0],
        [ 40,  96,  25],
        [ 25,  76,   7],
        ...,
        [252, 251, 255],
        [252, 251, 255],
        [253, 251, 255]],

       [[ 60, 120,  48],
        [ 73, 130,  59],
        [112, 163,  94],
        ...,
        [251, 251, 251],
        [252, 251, 255],
        [253, 252, 255]],

       ...,

       [[ 93, 112, 116],
        [ 88, 107, 111],
        [ 84, 103, 107],
        ...,
        [101, 112, 116],
        [100, 111, 115],
        [ 98, 109, 113]],

       [[ 88, 107, 111],
        [ 92, 111, 115],
        [ 95, 114, 118],
        ...,
        [111, 122, 126],
        [104, 115, 119],
        [101, 112, 116]],

       [[ 94, 113, 117],
        [ 93, 112, 116],
        [ 91, 110, 114],
        ...,
        [127, 138, 142],
        [114, 125, 129],
        [109, 120, 124]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<p>The 3D <code class="docutils literal notranslate"><span class="pre">img_color_array</span></code> has a size of <span class="math notranslate nohighlight">\((h, w, 3)\)</span>, where <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(w\)</span> are respectively the height and width of the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_color_array</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(182, 277, 3)
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">img_color_array</span></code> is made up by <span class="math notranslate nohighlight">\(h\)</span> 2D arrays of size <span class="math notranslate nohighlight">\(w\times 3\)</span>.</p>
<p>The <span class="math notranslate nohighlight">\(i\)</span>-th 2D array of <code class="docutils literal notranslate"><span class="pre">img_color_array</span></code>, namely <code class="docutils literal notranslate"><span class="pre">img_color_array[i,:]</span></code>, contains in its rows the 1D array that represents pixel <span class="math notranslate nohighlight">\((i,j)\)</span>, for <span class="math notranslate nohighlight">\(j=1,\dots,w\)</span>.</p>
<p>In other words, let <span class="math notranslate nohighlight">\(A(\mathcal{I})\)</span> be the 3D array <code class="docutils literal notranslate"><span class="pre">img_color_array</span></code>, it contains <span class="math notranslate nohighlight">\(h\)</span> 2D arrays <span class="math notranslate nohighlight">\(A(\mathcal{I})[i,:]\)</span>, that contains the pixels <span class="math notranslate nohighlight">\((p_{ij} : j=1,\dots,w)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}A(\mathcal{I})[i,:] = \begin{pmatrix} p_{i1}  \\
                                          p_{i2}  \\
                                          \dots \\
                                          p_{iw}
                         \end{pmatrix} = 
                         \begin{pmatrix} R_{i1} &amp; G_{i1} &amp; B_{i1}  \\
                                          R_{i2}&amp; G_{i2}&amp; B_{i2}   \\
                                          \dots &amp;  \dots &amp; \dots \\
                                          R_{iw}&amp; G_{iw}&amp; B_{iw}
                         \end{pmatrix} \end{split}\]</div>
<p>Therefore:</p>
<div class="math notranslate nohighlight">
\[A(\mathcal{I})[i,:][j,:] = p_{ij} = (R_{ij}, G_{ij}, B_{ij})\]</div>
<p>The flattened representation of <span class="math notranslate nohighlight">\(A(\mathcal{I})[i,:]\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\mathcal{F}(A(\mathcal{I})[i,:]) =  (p_{i1},  \dots ,  p_{iw})  = (R_{i1} , G_{i1} , B_{i1},   \dots, R_{iw}, G_{iw}, B_{iw})\]</div>
<p>So, we can construct the <span class="math notranslate nohighlight">\(M(\mathcal{I})\)</span> matrix as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
M(\mathcal{I}) =  \Bigl(\mathcal{F}(A(\mathcal{I})[i,:])\Bigr)_{\substack{i=1,..,h}} =
=                   
\begin{pmatrix} p_{11} &amp; \dots &amp; p_{1w}  \\
                p_{21} &amp; \dots&amp; p_{2w}  \\
                \dots &amp;\dots &amp;  \dots\\
                 p_{h1} &amp;  \dots&amp; p_{hw}
\end{pmatrix} 
=                    
\begin{pmatrix} R_{11} &amp; G_{11} &amp; B_{11}&amp;   \dots &amp; R_{1w}&amp; G_{1w}&amp; B_{1w}  \\
                R_{21} &amp; G_{21} &amp; B_{21}&amp;   \dots&amp; R_{2w}&amp; G_{2w}&amp; B_{2w}   \\
                \dots &amp;\dots &amp;  \dots&amp; \dots &amp; \dots &amp; \dots&amp; \dots\\
                 R_{h1} &amp; G_{h1} &amp; B_{h1}&amp;   \dots&amp; R_{hw}&amp; G_{hw}&amp; B_{hw}
\end{pmatrix}
\end{split}\]</div>
<p>For instance: <span class="math notranslate nohighlight">\(\hspace{0.1cm} p_{13}=\)</span><code class="docutils literal notranslate"><span class="pre">example_img_color_array[0,:][2,:]</span></code> = <code class="docutils literal notranslate"><span class="pre">example_img_color_array[0,2]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_color_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,:][</span><span class="mi">2</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 84, 136,  64], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_color_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 84, 136,  64], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<ul>
<li><p><strong>Building the pixels matrix for a color image: <span class="math notranslate nohighlight">\(M(\mathcal{I})\)</span></strong></p>
<p>We use the flatten procedure described above.</p>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">img_color_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">img_color_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">new_w</span> <span class="o">=</span> <span class="n">w</span><span class="o">*</span><span class="n">img_color_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">img_color_2D_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">h</span><span class="p">,</span><span class="n">new_w</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">h</span><span class="p">):</span>
    <span class="n">img_color_2D_array</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">img_color_array</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_color_2D_array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 17.,  73.,   0., ..., 254., 250., 255.],
       [  0.,  57.,   0., ..., 253., 251., 255.],
       [ 60., 120.,  48., ..., 253., 252., 255.],
       ...,
       [ 93., 112., 116., ...,  98., 109., 113.],
       [ 88., 107., 111., ..., 101., 112., 116.],
       [ 94., 113., 117., ..., 109., 120., 124.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_color_2D_array</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(182, 831)
</pre></div>
</div>
</div>
</div>
<p>We can plot the 2D array <code class="docutils literal notranslate"><span class="pre">img_color_2D_array</span></code> to realize how this representation of the original color image is not precise at all, since modify its size and remove the color pattern.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_color_2D_array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Hide the axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6fa85ec7fec21ef6eece2b7c6a8454cdb83ca549c67a63a5f12750d245b073a0.png" src="_images/6fa85ec7fec21ef6eece2b7c6a8454cdb83ca549c67a63a5f12750d245b073a0.png" />
</div>
</div>
<p>If we want to plot the original color image we need the 3D array <code class="docutils literal notranslate"><span class="pre">img_color_array</span></code> that contains all its information, specifically regarding the color and the size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_color_array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Hide the axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7e6911dc01bb00d4d4808dda17dee45b5b048c656d8ac971f8f09a964875960a.png" src="_images/7e6911dc01bb00d4d4808dda17dee45b5b048c656d8ac971f8f09a964875960a.png" />
</div>
</div>
</section>
</section>
<section id="pixel-features-array">
<h2><strong>Pixel features array</strong><a class="headerlink" href="#pixel-features-array" title="Link to this heading">#</a></h2>
<p>Once we know how to extract features of images the next step is to build a features array with those extracted features to be use along with Machine Learning models.</p>
<p>In this section this topic will be addressed following the different feature extraction method explained before.</p>
<p>Most part of Machine Learning algorithms need a matrix (2D array) as input, usually called features/predictors matrix, but other are able to work with tensor, that is, 3D arrays, usually refer as sequential data. This last is specially common in the Deep Learning field.</p>
<p>Here we will cover both approaches, so that we are going to learn how to build both predictors matrices and tensors.</p>
<section id="sequential-data-features-tensor">
<h3><strong>Sequential data: features tensor</strong><a class="headerlink" href="#sequential-data-features-tensor" title="Link to this heading">#</a></h3>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> images <span class="math notranslate nohighlight">\(\mathcal{I}_1,\dots , \mathcal{I}_n\)</span> of the same size <span class="math notranslate nohighlight">\(h\times w\)</span>.</p>
<p>Using the pixels method for features extraction, a features <strong>tensor</strong> for those images can be build as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X =   \begin{pmatrix} M(\mathcal{I}_1)  \\
                        M(\mathcal{I}_2)    \\
                        \dots  \\
                        M(\mathcal{I}_n) 
                        \end{pmatrix} \end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(M(\mathcal{I}_i)\)</span> is the pixels matrix of the image <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span>.</p>
<p>This tensor is a 3D array of size <span class="math notranslate nohighlight">\(n\times h\times w\)</span>  that contains the pixels matrix of each image, so, is an array with <span class="math notranslate nohighlight">\(n\)</span> matrices.</p>
</section>
<section id="tabular-data-features-matrix">
<h3><strong>Tabular data: features matrix</strong><a class="headerlink" href="#tabular-data-features-matrix" title="Link to this heading">#</a></h3>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> images <span class="math notranslate nohighlight">\(\mathcal{I}_1,\dots , \mathcal{I}_n\)</span> of the same size <span class="math notranslate nohighlight">\(h\times w\)</span>.</p>
<p>Using the pixels method for features extraction, a <strong>features matrix</strong> for those images can be build as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X =   \begin{pmatrix} v(\mathcal{I}_1)  \\
                        v(\mathcal{I}_2)    \\
                        \dots  \\
                        v(\mathcal{I}_n) 
                        \end{pmatrix} \end{split}\]</div>
<p>Where <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)\)</span> is the <strong>vectorial pixels representation</strong> (1D array) of the image <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span> and <span class="math notranslate nohighlight">\(p\)</span> is the length of <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)\)</span>.</p>
<p>This matrix is a 2D array of size <span class="math notranslate nohighlight">\(n\times p\)</span>  that contains the flattened pixels matrix (<code class="docutils literal notranslate"><span class="pre">img_pixels_array.flatten()</span></code>)  of each image, let say, the pixels vector of each image.</p>
<section id="vectorial-representation-of-an-image">
<h4><strong>Vectorial representation of an image</strong><a class="headerlink" href="#vectorial-representation-of-an-image" title="Link to this heading">#</a></h4>
<p><span class="math notranslate nohighlight">\(v(\mathcal{I}_i)\)</span> is the 1D array resulting of flatten <span class="math notranslate nohighlight">\(M(\mathcal{I}_i)\)</span> <span class="math notranslate nohighlight">\(\Rightarrow\)</span> <code class="docutils literal notranslate"><span class="pre">img_pixels_array.flatten()</span></code></p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span> is gray-scale:</p>
<div class="math notranslate nohighlight">
\[v(\mathcal{I}_i) = (p_{11}, \dots, p_{1w}, p_{21},\dots,p_{2w}, \dots,p_{h1},\dots,p_{hw})^{\prime}\]</div>
<p>with a size of <span class="math notranslate nohighlight">\(h\cdot w\)</span>.</p>
</li>
<li><p>If <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span> is color:</p>
<div class="math notranslate nohighlight">
\[v(\mathcal{I}_i) = (R_{11}, G_{11}, B_{11},\dots,R_{1w},G_{1w},B_{1w},\dots,R_{h1},G_{h1},B_{h1},\dots,R_{hw},G_{hw},B_{hw})^{\prime}\]</div>
<p>and its size is <span class="math notranslate nohighlight">\(3\cdot h \cdot w\)</span>.</p>
</li>
</ul>
<p>We can obtain the vectorial representation of both the gray and color-scale images using using the function <code class="docutils literal notranslate"><span class="pre">flatten()</span></code> on <code class="docutils literal notranslate"><span class="pre">img_gray_array</span></code> and <code class="docutils literal notranslate"><span class="pre">img_color_array</span></code>, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_gray_pixels_vector</span> <span class="o">=</span> <span class="n">img_gray_array</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">img_gray_pixels_vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 48,  87, 112, ..., 135, 122, 117], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_color_pixels_vector</span> <span class="o">=</span> <span class="n">img_color_array</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">img_color_pixels_vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 17,  73,   0, ..., 109, 120, 124], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Extracting the vector <code class="docutils literal notranslate"><span class="pre">img_pixels_vector</span></code> for each image on the data-set and concatenating them by rows we obtain a <strong>pixels features matrix</strong>.</p>
</div></blockquote>
<p>Once we have  $<span class="math notranslate nohighlight">\(X =   \begin{pmatrix} v(\mathcal{I}_1)  \\
                        v(\mathcal{I}_2)    \\
                        \dots  \\
                        v(\mathcal{I}_n) 
                        \end{pmatrix} \)</span>$</p>
<p>we have a quantitative predictors matrix with images as rows (observations/individuals) and pixels (gray-scale) or channel-pixels (color-scale) as columns (features/predictors).</p>
<p>This matrix is <span class="math notranslate nohighlight">\(n\times p\)</span> size, with <span class="math notranslate nohighlight">\(p=h\cdot w\)</span> if images are gray-scale, and <span class="math notranslate nohighlight">\(p=3\cdot h \cdot w\)</span> if images are color-scale.</p>
<ul>
<li><p>The <strong>problem</strong> of this approach is the <strong>high dimensionality</strong> on <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>To solve this <strong>dimensionality reduction</strong> techniques such as PCA could be used.</p>
</li>
</ul>
<p><strong>Plotting vector as image</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_gray_pixels_vector</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img_gray_array</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Hide the axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5af423cb23969bb6a30a6eca85e4f0028f5c1ed99291798a9943b4ff50f8baa8.png" src="_images/5af423cb23969bb6a30a6eca85e4f0028f5c1ed99291798a9943b4ff50f8baa8.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_color_pixels_vector</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">img_color_array</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Hide the axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7e6911dc01bb00d4d4808dda17dee45b5b048c656d8ac971f8f09a964875960a.png" src="_images/7e6911dc01bb00d4d4808dda17dee45b5b048c656d8ac971f8f09a964875960a.png" />
</div>
</div>
</section>
</section>
<section id="getting-pixels-features-matrix-for-gray-scale-images">
<h3><strong>Getting pixels features matrix for gray-scale images</strong><a class="headerlink" href="#getting-pixels-features-matrix-for-gray-scale-images" title="Link to this heading">#</a></h3>
<p>In this section we are going to use the  class <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features array from data-sets of images, allowing different method for features extraction as well as different functionalities like working with both color and gray images, many filters, different formats and strategies for the different features extraction methods and so on.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> will be applied with the <strong>pixels</strong> method for feature extraction on <strong>gray-scale</strong> images, using the data-set of images presented above.</p>
<ul class="simple">
<li><p><strong>Array format</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Defining the desired size of the images</span>
<span class="n">img_height</span> <span class="o">=</span> <span class="mi">240</span>
<span class="n">img_width</span> <span class="o">=</span> <span class="mi">184</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>

<span class="n">gray_pixels_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 26,  19,  28, ..., 115, 110, 109],
       [ 44,  96, 109, ..., 151, 149, 149],
       [ 62, 102,  75, ..., 109, 131, 118],
       ...,
       [ 11,  10,  10, ...,   1,   2,   2],
       [  5,   6,   6, ...,   6,   4,  27],
       [148, 150, 152, ...,  33,  43,  48]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 44160)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Data-frame format</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;data-frame&#39;</span><span class="p">)</span>

<span class="n">gray_pixels_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (300, 44_160)</small><table border="1" class="dataframe"><thead><tr><th>pixel_1_1</th><th>pixel_1_2</th><th>pixel_1_3</th><th>pixel_1_4</th><th>pixel_1_5</th><th>pixel_1_6</th><th>pixel_1_7</th><th>pixel_1_8</th><th>pixel_1_9</th><th>pixel_1_10</th><th>pixel_1_11</th><th>pixel_1_12</th><th>pixel_1_13</th><th>pixel_1_14</th><th>pixel_1_15</th><th>pixel_1_16</th><th>pixel_1_17</th><th>pixel_1_18</th><th>pixel_1_19</th><th>pixel_1_20</th><th>pixel_1_21</th><th>pixel_1_22</th><th>pixel_1_23</th><th>pixel_1_24</th><th>pixel_1_25</th><th>pixel_1_26</th><th>pixel_1_27</th><th>pixel_1_28</th><th>pixel_1_29</th><th>pixel_1_30</th><th>pixel_1_31</th><th>pixel_1_32</th><th>pixel_1_33</th><th>pixel_1_34</th><th>pixel_1_35</th><th>pixel_1_36</th><th>pixel_1_37</th><th>&hellip;</th><th>pixel_184_204</th><th>pixel_184_205</th><th>pixel_184_206</th><th>pixel_184_207</th><th>pixel_184_208</th><th>pixel_184_209</th><th>pixel_184_210</th><th>pixel_184_211</th><th>pixel_184_212</th><th>pixel_184_213</th><th>pixel_184_214</th><th>pixel_184_215</th><th>pixel_184_216</th><th>pixel_184_217</th><th>pixel_184_218</th><th>pixel_184_219</th><th>pixel_184_220</th><th>pixel_184_221</th><th>pixel_184_222</th><th>pixel_184_223</th><th>pixel_184_224</th><th>pixel_184_225</th><th>pixel_184_226</th><th>pixel_184_227</th><th>pixel_184_228</th><th>pixel_184_229</th><th>pixel_184_230</th><th>pixel_184_231</th><th>pixel_184_232</th><th>pixel_184_233</th><th>pixel_184_234</th><th>pixel_184_235</th><th>pixel_184_236</th><th>pixel_184_237</th><th>pixel_184_238</th><th>pixel_184_239</th><th>pixel_184_240</th></tr><tr><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>&hellip;</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td></tr></thead><tbody><tr><td>26</td><td>19</td><td>28</td><td>50</td><td>75</td><td>17</td><td>37</td><td>32</td><td>47</td><td>75</td><td>72</td><td>28</td><td>29</td><td>20</td><td>24</td><td>21</td><td>49</td><td>87</td><td>91</td><td>80</td><td>56</td><td>48</td><td>87</td><td>117</td><td>98</td><td>81</td><td>86</td><td>73</td><td>57</td><td>56</td><td>65</td><td>99</td><td>68</td><td>76</td><td>81</td><td>85</td><td>83</td><td>&hellip;</td><td>87</td><td>89</td><td>96</td><td>98</td><td>90</td><td>78</td><td>68</td><td>68</td><td>67</td><td>52</td><td>59</td><td>59</td><td>71</td><td>71</td><td>79</td><td>75</td><td>63</td><td>63</td><td>68</td><td>74</td><td>80</td><td>145</td><td>175</td><td>171</td><td>127</td><td>174</td><td>153</td><td>113</td><td>126</td><td>105</td><td>110</td><td>113</td><td>128</td><td>121</td><td>115</td><td>110</td><td>109</td></tr><tr><td>44</td><td>96</td><td>109</td><td>49</td><td>70</td><td>50</td><td>65</td><td>73</td><td>100</td><td>83</td><td>89</td><td>117</td><td>151</td><td>148</td><td>169</td><td>160</td><td>62</td><td>82</td><td>115</td><td>78</td><td>86</td><td>152</td><td>190</td><td>205</td><td>211</td><td>193</td><td>187</td><td>183</td><td>180</td><td>188</td><td>144</td><td>109</td><td>145</td><td>108</td><td>66</td><td>56</td><td>126</td><td>&hellip;</td><td>155</td><td>155</td><td>157</td><td>158</td><td>156</td><td>151</td><td>153</td><td>160</td><td>161</td><td>161</td><td>161</td><td>156</td><td>159</td><td>159</td><td>124</td><td>125</td><td>153</td><td>151</td><td>153</td><td>156</td><td>158</td><td>157</td><td>153</td><td>152</td><td>154</td><td>153</td><td>153</td><td>152</td><td>152</td><td>155</td><td>155</td><td>153</td><td>152</td><td>151</td><td>151</td><td>149</td><td>149</td></tr><tr><td>62</td><td>102</td><td>75</td><td>82</td><td>156</td><td>122</td><td>90</td><td>113</td><td>37</td><td>44</td><td>44</td><td>52</td><td>45</td><td>40</td><td>73</td><td>52</td><td>38</td><td>85</td><td>100</td><td>47</td><td>135</td><td>176</td><td>93</td><td>114</td><td>59</td><td>53</td><td>34</td><td>30</td><td>46</td><td>37</td><td>53</td><td>87</td><td>87</td><td>81</td><td>71</td><td>102</td><td>76</td><td>&hellip;</td><td>108</td><td>120</td><td>117</td><td>111</td><td>108</td><td>106</td><td>111</td><td>114</td><td>114</td><td>97</td><td>105</td><td>116</td><td>109</td><td>109</td><td>107</td><td>108</td><td>109</td><td>104</td><td>108</td><td>114</td><td>109</td><td>100</td><td>114</td><td>107</td><td>116</td><td>120</td><td>110</td><td>108</td><td>115</td><td>110</td><td>109</td><td>109</td><td>105</td><td>108</td><td>109</td><td>131</td><td>118</td></tr><tr><td>133</td><td>105</td><td>51</td><td>110</td><td>130</td><td>127</td><td>137</td><td>84</td><td>103</td><td>120</td><td>129</td><td>140</td><td>111</td><td>80</td><td>144</td><td>103</td><td>99</td><td>111</td><td>107</td><td>59</td><td>103</td><td>111</td><td>84</td><td>88</td><td>84</td><td>115</td><td>139</td><td>146</td><td>153</td><td>161</td><td>176</td><td>159</td><td>148</td><td>131</td><td>155</td><td>122</td><td>71</td><td>&hellip;</td><td>80</td><td>81</td><td>82</td><td>80</td><td>81</td><td>83</td><td>85</td><td>86</td><td>89</td><td>91</td><td>92</td><td>93</td><td>93</td><td>96</td><td>98</td><td>99</td><td>95</td><td>79</td><td>59</td><td>47</td><td>45</td><td>34</td><td>40</td><td>46</td><td>87</td><td>100</td><td>95</td><td>93</td><td>94</td><td>91</td><td>85</td><td>89</td><td>93</td><td>98</td><td>99</td><td>92</td><td>92</td></tr><tr><td>235</td><td>246</td><td>250</td><td>247</td><td>248</td><td>245</td><td>241</td><td>237</td><td>240</td><td>248</td><td>249</td><td>244</td><td>242</td><td>241</td><td>245</td><td>231</td><td>230</td><td>236</td><td>241</td><td>243</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>242</td><td>243</td><td>243</td><td>243</td><td>243</td><td>243</td><td>&hellip;</td><td>161</td><td>154</td><td>150</td><td>150</td><td>151</td><td>162</td><td>148</td><td>137</td><td>143</td><td>156</td><td>157</td><td>163</td><td>149</td><td>148</td><td>144</td><td>139</td><td>133</td><td>147</td><td>140</td><td>140</td><td>142</td><td>151</td><td>138</td><td>150</td><td>140</td><td>125</td><td>128</td><td>133</td><td>135</td><td>138</td><td>159</td><td>161</td><td>119</td><td>107</td><td>142</td><td>150</td><td>145</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>93</td><td>86</td><td>95</td><td>87</td><td>89</td><td>153</td><td>138</td><td>99</td><td>118</td><td>93</td><td>104</td><td>104</td><td>122</td><td>83</td><td>84</td><td>104</td><td>72</td><td>86</td><td>63</td><td>70</td><td>101</td><td>75</td><td>81</td><td>133</td><td>121</td><td>88</td><td>87</td><td>88</td><td>91</td><td>88</td><td>100</td><td>107</td><td>80</td><td>88</td><td>98</td><td>101</td><td>100</td><td>&hellip;</td><td>107</td><td>107</td><td>107</td><td>107</td><td>107</td><td>108</td><td>108</td><td>108</td><td>108</td><td>108</td><td>108</td><td>109</td><td>109</td><td>110</td><td>110</td><td>110</td><td>109</td><td>108</td><td>108</td><td>109</td><td>109</td><td>110</td><td>111</td><td>111</td><td>111</td><td>111</td><td>111</td><td>111</td><td>111</td><td>111</td><td>111</td><td>110</td><td>109</td><td>109</td><td>109</td><td>110</td><td>111</td></tr><tr><td>4</td><td>6</td><td>7</td><td>9</td><td>11</td><td>8</td><td>7</td><td>6</td><td>3</td><td>2</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>6</td><td>6</td><td>6</td><td>6</td><td>6</td><td>8</td><td>8</td><td>8</td><td>8</td><td>8</td><td>11</td><td>15</td><td>19</td><td>23</td><td>28</td><td>18</td><td>11</td><td>10</td><td>12</td><td>17</td><td>21</td><td>30</td><td>&hellip;</td><td>122</td><td>126</td><td>121</td><td>104</td><td>104</td><td>106</td><td>111</td><td>112</td><td>118</td><td>114</td><td>97</td><td>109</td><td>121</td><td>115</td><td>116</td><td>120</td><td>124</td><td>112</td><td>106</td><td>110</td><td>126</td><td>111</td><td>107</td><td>101</td><td>91</td><td>85</td><td>79</td><td>91</td><td>80</td><td>75</td><td>87</td><td>86</td><td>74</td><td>99</td><td>94</td><td>79</td><td>77</td></tr><tr><td>11</td><td>10</td><td>10</td><td>10</td><td>9</td><td>9</td><td>9</td><td>9</td><td>10</td><td>10</td><td>11</td><td>10</td><td>10</td><td>10</td><td>11</td><td>12</td><td>12</td><td>13</td><td>13</td><td>13</td><td>13</td><td>13</td><td>13</td><td>12</td><td>13</td><td>13</td><td>14</td><td>14</td><td>15</td><td>17</td><td>18</td><td>19</td><td>20</td><td>21</td><td>23</td><td>23</td><td>25</td><td>&hellip;</td><td>1</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>2</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>2</td><td>2</td></tr><tr><td>5</td><td>6</td><td>6</td><td>7</td><td>7</td><td>10</td><td>10</td><td>10</td><td>10</td><td>11</td><td>12</td><td>12</td><td>12</td><td>12</td><td>13</td><td>14</td><td>14</td><td>16</td><td>17</td><td>18</td><td>19</td><td>21</td><td>23</td><td>26</td><td>26</td><td>26</td><td>26</td><td>26</td><td>26</td><td>27</td><td>29</td><td>30</td><td>32</td><td>33</td><td>36</td><td>36</td><td>34</td><td>&hellip;</td><td>23</td><td>28</td><td>39</td><td>64</td><td>35</td><td>32</td><td>21</td><td>17</td><td>22</td><td>27</td><td>52</td><td>41</td><td>35</td><td>44</td><td>73</td><td>67</td><td>56</td><td>45</td><td>39</td><td>37</td><td>34</td><td>44</td><td>53</td><td>57</td><td>52</td><td>51</td><td>38</td><td>21</td><td>8</td><td>9</td><td>23</td><td>2</td><td>0</td><td>1</td><td>6</td><td>4</td><td>27</td></tr><tr><td>148</td><td>150</td><td>152</td><td>156</td><td>157</td><td>156</td><td>156</td><td>159</td><td>158</td><td>154</td><td>152</td><td>154</td><td>149</td><td>142</td><td>133</td><td>128</td><td>117</td><td>112</td><td>111</td><td>109</td><td>107</td><td>105</td><td>104</td><td>110</td><td>117</td><td>124</td><td>130</td><td>141</td><td>146</td><td>150</td><td>155</td><td>158</td><td>157</td><td>157</td><td>157</td><td>158</td><td>161</td><td>&hellip;</td><td>53</td><td>52</td><td>61</td><td>65</td><td>63</td><td>62</td><td>60</td><td>57</td><td>56</td><td>54</td><td>57</td><td>58</td><td>66</td><td>63</td><td>57</td><td>63</td><td>51</td><td>52</td><td>51</td><td>48</td><td>57</td><td>51</td><td>65</td><td>62</td><td>61</td><td>63</td><td>55</td><td>50</td><td>41</td><td>47</td><td>49</td><td>44</td><td>50</td><td>48</td><td>33</td><td>43</td><td>48</td></tr></tbody></table></div></div></div>
</div>
<ul class="simple">
<li><p><strong>Applying equalization</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;equalized&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>

<span class="n">gray_pixels_features_filtered_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_filtered_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[6.91349638e-02, 4.56748188e-02, 7.71739130e-02, ...,
        5.79211957e-01, 5.48550725e-01, 5.41802536e-01],
       [6.11186594e-02, 3.41553442e-01, 4.19723732e-01, ...,
        6.42255435e-01, 6.28736413e-01, 6.28736413e-01],
       [3.23596014e-01, 6.44021739e-01, 4.18025362e-01, ...,
        7.19791667e-01, 8.49682971e-01, 8.01041667e-01],
       ...,
       [5.70312500e-01, 5.47961957e-01, 5.47961957e-01, ...,
        9.89130435e-02, 2.85665761e-01, 2.85665761e-01],
       [2.26449275e-04, 4.30253623e-04, 4.30253623e-04, ...,
        4.30253623e-04, 9.05797101e-05, 8.42617754e-02],
       [8.93432971e-01, 8.99230072e-01, 9.05049819e-01, ...,
        6.14356884e-02, 1.38337862e-01, 1.81227355e-01]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_filtered_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 44160)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Applying sobel filter</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;sobel&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>

<span class="n">gray_pixels_features_filtered_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_filtered_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2.6925824 , 13.        , 20.98809186, ...,  7.77817459,
         4.24264069,  0.70710678],
       [37.83186488, 50.25497488, 32.669749  , ...,  1.60078106,
         1.41421356,  0.        ],
       [27.90721233, 18.51013236, 17.83605898, ..., 15.39683409,
         7.8142498 ,  9.48683298],
       ...,
       [ 0.70710678,  0.70710678,  0.        , ...,  0.70710678,
         0.70710678,  0.        ],
       [ 0.75      ,  0.55901699,  0.70710678, ..., 27.0935878 ,
        28.7108429 , 15.97654531],
       [11.01135777, 12.35161933, 14.63087489, ...,  2.15058132,
        10.85414667,  4.27200187]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_filtered_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 44160)
</pre></div>
</div>
</div>
</div>
</section>
<section id="getting-pixels-features-matrix-for-color-images">
<h3><strong>Getting pixels features matrix for color images</strong><a class="headerlink" href="#getting-pixels-features-matrix-for-color-images" title="Link to this heading">#</a></h3>
<p>In this section we are going to use the  class <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features matrices from data-sets of images, allowing different method for features extraction as well as different functionalities like working with both color and gray images, many filters, different formats and strategies for the different features extraction methods and so on.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> will be applied with the <strong>pixels</strong> method for feature extraction on <strong>color</strong> images, using the data-set of images presented above.</p>
<ul class="simple">
<li><p><strong>Array format</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>

<span class="n">color_pixels_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 23,  28,  21, ..., 120, 111,  72],
       [ 43,  48,  26, ..., 136, 152, 168],
       [ 31,  87,  13, ..., 110, 121, 125],
       ...,
       [ 26,   5,   2, ...,   3,   1,   2],
       [ 18,   0,   0, ...,  41,  22,  14],
       [105, 155, 224, ...,  63,  44,  29]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 132480)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Data-frame format</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;data-frame&#39;</span><span class="p">)</span>

<span class="n">color_pixels_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><style>
.dataframe > thead > tr,
.dataframe > tbody > tr {
  text-align: right;
  white-space: pre-wrap;
}
</style>
<small>shape: (300, 132_480)</small><table border="1" class="dataframe"><thead><tr><th>R_1_1</th><th>G_1_1</th><th>B_1_1</th><th>R_1_2</th><th>G_1_2</th><th>B_1_2</th><th>R_1_3</th><th>G_1_3</th><th>B_1_3</th><th>R_1_4</th><th>G_1_4</th><th>B_1_4</th><th>R_1_5</th><th>G_1_5</th><th>B_1_5</th><th>R_1_6</th><th>G_1_6</th><th>B_1_6</th><th>R_1_7</th><th>G_1_7</th><th>B_1_7</th><th>R_1_8</th><th>G_1_8</th><th>B_1_8</th><th>R_1_9</th><th>G_1_9</th><th>B_1_9</th><th>R_1_10</th><th>G_1_10</th><th>B_1_10</th><th>R_1_11</th><th>G_1_11</th><th>B_1_11</th><th>R_1_12</th><th>G_1_12</th><th>B_1_12</th><th>R_1_13</th><th>&hellip;</th><th>B_184_228</th><th>R_184_229</th><th>G_184_229</th><th>B_184_229</th><th>R_184_230</th><th>G_184_230</th><th>B_184_230</th><th>R_184_231</th><th>G_184_231</th><th>B_184_231</th><th>R_184_232</th><th>G_184_232</th><th>B_184_232</th><th>R_184_233</th><th>G_184_233</th><th>B_184_233</th><th>R_184_234</th><th>G_184_234</th><th>B_184_234</th><th>R_184_235</th><th>G_184_235</th><th>B_184_235</th><th>R_184_236</th><th>G_184_236</th><th>B_184_236</th><th>R_184_237</th><th>G_184_237</th><th>B_184_237</th><th>R_184_238</th><th>G_184_238</th><th>B_184_238</th><th>R_184_239</th><th>G_184_239</th><th>B_184_239</th><th>R_184_240</th><th>G_184_240</th><th>B_184_240</th></tr><tr><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>&hellip;</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td><td>u8</td></tr></thead><tbody><tr><td>23</td><td>28</td><td>21</td><td>15</td><td>22</td><td>12</td><td>25</td><td>31</td><td>19</td><td>47</td><td>53</td><td>40</td><td>72</td><td>79</td><td>63</td><td>14</td><td>21</td><td>4</td><td>34</td><td>41</td><td>26</td><td>29</td><td>35</td><td>21</td><td>44</td><td>50</td><td>40</td><td>72</td><td>77</td><td>72</td><td>69</td><td>74</td><td>69</td><td>25</td><td>29</td><td>30</td><td>26</td><td>&hellip;</td><td>108</td><td>188</td><td>171</td><td>153</td><td>167</td><td>150</td><td>130</td><td>127</td><td>111</td><td>88</td><td>138</td><td>125</td><td>98</td><td>118</td><td>104</td><td>75</td><td>121</td><td>110</td><td>77</td><td>124</td><td>114</td><td>78</td><td>139</td><td>130</td><td>93</td><td>130</td><td>123</td><td>83</td><td>125</td><td>117</td><td>76</td><td>121</td><td>112</td><td>73</td><td>120</td><td>111</td><td>72</td></tr><tr><td>43</td><td>48</td><td>26</td><td>94</td><td>100</td><td>80</td><td>105</td><td>114</td><td>97</td><td>42</td><td>54</td><td>40</td><td>62</td><td>75</td><td>65</td><td>42</td><td>55</td><td>48</td><td>57</td><td>69</td><td>66</td><td>66</td><td>76</td><td>75</td><td>95</td><td>103</td><td>102</td><td>80</td><td>84</td><td>84</td><td>88</td><td>90</td><td>88</td><td>116</td><td>116</td><td>124</td><td>150</td><td>&hellip;</td><td>163</td><td>146</td><td>155</td><td>162</td><td>146</td><td>155</td><td>162</td><td>145</td><td>154</td><td>162</td><td>145</td><td>154</td><td>163</td><td>148</td><td>156</td><td>166</td><td>148</td><td>156</td><td>167</td><td>146</td><td>154</td><td>165</td><td>145</td><td>153</td><td>166</td><td>145</td><td>152</td><td>165</td><td>143</td><td>152</td><td>165</td><td>136</td><td>152</td><td>168</td><td>136</td><td>152</td><td>168</td></tr><tr><td>31</td><td>87</td><td>13</td><td>74</td><td>126</td><td>54</td><td>50</td><td>97</td><td>27</td><td>56</td><td>105</td><td>34</td><td>127</td><td>180</td><td>108</td><td>88</td><td>148</td><td>73</td><td>55</td><td>117</td><td>41</td><td>83</td><td>137</td><td>65</td><td>17</td><td>55</td><td>0</td><td>36</td><td>57</td><td>0</td><td>29</td><td>61</td><td>0</td><td>16</td><td>79</td><td>6</td><td>12</td><td>&hellip;</td><td>116</td><td>115</td><td>123</td><td>120</td><td>106</td><td>112</td><td>110</td><td>105</td><td>109</td><td>110</td><td>111</td><td>116</td><td>117</td><td>105</td><td>111</td><td>114</td><td>101</td><td>112</td><td>113</td><td>98</td><td>113</td><td>113</td><td>92</td><td>110</td><td>110</td><td>97</td><td>112</td><td>114</td><td>101</td><td>112</td><td>116</td><td>123</td><td>134</td><td>138</td><td>110</td><td>121</td><td>125</td></tr><tr><td>153</td><td>127</td><td>110</td><td>121</td><td>102</td><td>81</td><td>62</td><td>50</td><td>25</td><td>117</td><td>112</td><td>82</td><td>139</td><td>131</td><td>100</td><td>141</td><td>125</td><td>97</td><td>157</td><td>132</td><td>107</td><td>104</td><td>79</td><td>56</td><td>119</td><td>100</td><td>76</td><td>131</td><td>119</td><td>97</td><td>138</td><td>129</td><td>106</td><td>155</td><td>137</td><td>117</td><td>125</td><td>&hellip;</td><td>74</td><td>103</td><td>101</td><td>88</td><td>98</td><td>96</td><td>83</td><td>96</td><td>94</td><td>81</td><td>97</td><td>95</td><td>82</td><td>94</td><td>92</td><td>79</td><td>88</td><td>86</td><td>73</td><td>92</td><td>90</td><td>77</td><td>96</td><td>94</td><td>81</td><td>101</td><td>99</td><td>86</td><td>102</td><td>100</td><td>87</td><td>95</td><td>93</td><td>80</td><td>95</td><td>93</td><td>80</td></tr><tr><td>235</td><td>235</td><td>237</td><td>246</td><td>246</td><td>248</td><td>250</td><td>250</td><td>252</td><td>247</td><td>247</td><td>249</td><td>248</td><td>248</td><td>250</td><td>245</td><td>245</td><td>247</td><td>241</td><td>241</td><td>243</td><td>237</td><td>237</td><td>239</td><td>240</td><td>240</td><td>242</td><td>248</td><td>248</td><td>250</td><td>249</td><td>249</td><td>252</td><td>244</td><td>243</td><td>249</td><td>242</td><td>&hellip;</td><td>124</td><td>133</td><td>124</td><td>109</td><td>136</td><td>127</td><td>112</td><td>141</td><td>132</td><td>117</td><td>143</td><td>134</td><td>119</td><td>146</td><td>137</td><td>122</td><td>167</td><td>158</td><td>143</td><td>169</td><td>160</td><td>145</td><td>127</td><td>118</td><td>103</td><td>115</td><td>106</td><td>91</td><td>150</td><td>141</td><td>126</td><td>158</td><td>149</td><td>134</td><td>153</td><td>144</td><td>129</td></tr><tr><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td><td>&hellip;</td></tr><tr><td>99</td><td>97</td><td>59</td><td>92</td><td>90</td><td>52</td><td>101</td><td>99</td><td>61</td><td>93</td><td>91</td><td>53</td><td>95</td><td>93</td><td>55</td><td>159</td><td>157</td><td>119</td><td>144</td><td>142</td><td>104</td><td>105</td><td>103</td><td>65</td><td>124</td><td>122</td><td>84</td><td>99</td><td>97</td><td>57</td><td>111</td><td>108</td><td>67</td><td>112</td><td>108</td><td>66</td><td>130</td><td>&hellip;</td><td>116</td><td>105</td><td>113</td><td>116</td><td>105</td><td>113</td><td>116</td><td>105</td><td>113</td><td>116</td><td>105</td><td>113</td><td>116</td><td>105</td><td>113</td><td>116</td><td>105</td><td>113</td><td>116</td><td>104</td><td>112</td><td>115</td><td>103</td><td>111</td><td>114</td><td>105</td><td>110</td><td>114</td><td>106</td><td>109</td><td>114</td><td>107</td><td>110</td><td>115</td><td>108</td><td>111</td><td>116</td></tr><tr><td>4</td><td>5</td><td>0</td><td>6</td><td>7</td><td>2</td><td>7</td><td>8</td><td>3</td><td>9</td><td>10</td><td>5</td><td>11</td><td>12</td><td>7</td><td>8</td><td>9</td><td>4</td><td>7</td><td>8</td><td>3</td><td>6</td><td>7</td><td>2</td><td>3</td><td>4</td><td>0</td><td>2</td><td>3</td><td>0</td><td>2</td><td>3</td><td>0</td><td>3</td><td>4</td><td>0</td><td>4</td><td>&hellip;</td><td>25</td><td>106</td><td>86</td><td>22</td><td>100</td><td>80</td><td>17</td><td>111</td><td>93</td><td>30</td><td>100</td><td>82</td><td>20</td><td>94</td><td>77</td><td>15</td><td>105</td><td>89</td><td>29</td><td>103</td><td>89</td><td>28</td><td>91</td><td>76</td><td>16</td><td>116</td><td>101</td><td>42</td><td>109</td><td>97</td><td>37</td><td>94</td><td>83</td><td>20</td><td>92</td><td>81</td><td>17</td></tr><tr><td>26</td><td>5</td><td>2</td><td>25</td><td>4</td><td>1</td><td>25</td><td>4</td><td>1</td><td>25</td><td>4</td><td>1</td><td>24</td><td>3</td><td>0</td><td>24</td><td>3</td><td>0</td><td>23</td><td>4</td><td>0</td><td>23</td><td>4</td><td>0</td><td>26</td><td>4</td><td>1</td><td>27</td><td>3</td><td>1</td><td>29</td><td>3</td><td>2</td><td>28</td><td>3</td><td>1</td><td>30</td><td>&hellip;</td><td>0</td><td>6</td><td>0</td><td>0</td><td>6</td><td>0</td><td>0</td><td>6</td><td>0</td><td>0</td><td>6</td><td>0</td><td>0</td><td>3</td><td>1</td><td>0</td><td>2</td><td>1</td><td>0</td><td>2</td><td>1</td><td>0</td><td>2</td><td>1</td><td>0</td><td>2</td><td>1</td><td>0</td><td>2</td><td>1</td><td>0</td><td>3</td><td>1</td><td>2</td><td>3</td><td>1</td><td>2</td></tr><tr><td>18</td><td>0</td><td>0</td><td>19</td><td>1</td><td>0</td><td>19</td><td>1</td><td>0</td><td>20</td><td>2</td><td>0</td><td>20</td><td>2</td><td>0</td><td>23</td><td>5</td><td>1</td><td>23</td><td>6</td><td>0</td><td>23</td><td>6</td><td>0</td><td>23</td><td>6</td><td>0</td><td>24</td><td>6</td><td>0</td><td>27</td><td>6</td><td>1</td><td>27</td><td>6</td><td>1</td><td>25</td><td>&hellip;</td><td>5</td><td>95</td><td>37</td><td>10</td><td>73</td><td>26</td><td>8</td><td>49</td><td>11</td><td>2</td><td>26</td><td>0</td><td>0</td><td>26</td><td>2</td><td>3</td><td>33</td><td>18</td><td>19</td><td>6</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>4</td><td>0</td><td>0</td><td>14</td><td>2</td><td>2</td><td>13</td><td>0</td><td>0</td><td>41</td><td>22</td><td>14</td></tr><tr><td>105</td><td>155</td><td>224</td><td>107</td><td>157</td><td>226</td><td>109</td><td>159</td><td>228</td><td>113</td><td>163</td><td>229</td><td>115</td><td>164</td><td>231</td><td>115</td><td>163</td><td>229</td><td>115</td><td>163</td><td>229</td><td>119</td><td>165</td><td>230</td><td>119</td><td>164</td><td>229</td><td>115</td><td>160</td><td>225</td><td>113</td><td>159</td><td>222</td><td>113</td><td>161</td><td>225</td><td>108</td><td>&hellip;</td><td>36</td><td>78</td><td>60</td><td>38</td><td>70</td><td>52</td><td>30</td><td>65</td><td>47</td><td>25</td><td>56</td><td>38</td><td>16</td><td>62</td><td>44</td><td>24</td><td>64</td><td>46</td><td>26</td><td>59</td><td>40</td><td>23</td><td>65</td><td>46</td><td>29</td><td>63</td><td>44</td><td>30</td><td>48</td><td>29</td><td>14</td><td>58</td><td>39</td><td>24</td><td>63</td><td>44</td><td>29</td></tr></tbody></table></div></div></div>
</div>
<ul class="simple">
<li><p><strong>Applying equalization</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;equalized&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>

<span class="n">color_pixels_features_filtered_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_filtered_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[4.65089942e-02, 5.66196451e-02, 4.24647339e-02, ...,
        5.48270993e-01, 5.07150669e-01, 3.28962596e-01],
       [4.72852531e-02, 5.27835383e-02, 2.85910833e-02, ...,
        6.21546825e-01, 6.94669981e-01, 7.67793137e-01],
       [1.28630418e-01, 3.60995045e-01, 5.39417883e-02, ...,
        6.55259591e-01, 7.20785550e-01, 7.44613171e-01],
       ...,
       [5.26830199e-01, 1.01313500e-01, 4.05253999e-02, ...,
        6.63003517e-02, 2.21001172e-02, 4.42002344e-02],
       [2.52291134e-04, 0.00000000e+00, 0.00000000e+00, ...,
        2.30458316e-02, 1.23660560e-02, 7.86930834e-03],
       [3.94867372e-01, 5.82899453e-01, 8.42383726e-01, ...,
        2.05513093e-01, 1.43532954e-01, 9.46012648e-02]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_filtered_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 132480)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Applying canny filter</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;pixels&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> 
                                                 <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;canny&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>

<span class="n">color_pixels_features_filtered_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_filtered_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.00900378, 0.01096112, 0.00822084, ..., 0.00277297, 0.002565  ,
        0.00166378],
       [0.13352273, 0.14904863, 0.08073467, ..., 0.00224478, 0.00250888,
        0.00277297],
       [0.03868009, 0.10855381, 0.01622068, ..., 0.03273887, 0.03601276,
        0.03720327],
       ...,
       [0.00277297, 0.00053326, 0.00021331, ..., 0.        , 0.        ,
        0.        ],
       [0.00277297, 0.        , 0.        , ..., 0.06980089, 0.03745414,
        0.02383445],
       [0.02024147, 0.02988026, 0.0431818 , ..., 0.01675295, 0.01170047,
        0.00771167]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_filtered_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 132480)
</pre></div>
</div>
</div>
</div>
</section>
<section id="getting-pixels-features-tensor-for-gray-scale-images">
<h3><strong>Getting pixels features tensor for gray-scale images</strong><a class="headerlink" href="#getting-pixels-features-tensor-for-gray-scale-images" title="Link to this heading">#</a></h3>
<p>In this section we are going to present the  class <code class="docutils literal notranslate"><span class="pre">ImageTensorFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features tensors from data-sets of images, is based in the pixels method for features extraction, and allows both color and gray images, and different formats to deal with the color images.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageTensorFeaturesExtraction</span></code> will be applied on gray-scale images, using the data-set of images presented above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageTensorFeaturesExtraction</span><span class="p">(</span><span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gray_pixels_features_tensor</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 26,  19,  28, ...,  75,  63,  59],
        [ 21,  48,  43, ...,  81,  53,  46],
        [ 21,  49,  47, ...,  92,  59,  44],
        ...,
        [145, 206, 205, ..., 119, 110, 109],
        [130, 185, 173, ..., 115, 110, 109],
        [136, 163, 170, ..., 115, 110, 109]],

       [[ 44,  96, 109, ..., 225, 233, 229],
        [ 42, 100, 130, ..., 220, 235, 246],
        [ 61,  77, 139, ..., 218, 241, 239],
        ...,
        [ 73,  70,  80, ..., 151, 153, 153],
        [ 71,  69,  77, ..., 151, 149, 149],
        [ 71,  69,  78, ..., 151, 149, 149]],

       [[ 62, 102,  75, ..., 251, 251, 252],
        [ 49,  70,  60, ..., 251, 252, 252],
        [ 65,  83,  85, ..., 251, 252, 252],
        ...,
        [104, 105, 102, ..., 103, 113, 108],
        [105, 108, 103, ..., 105, 122, 113],
        [108, 106, 102, ..., 109, 131, 118]],

       ...,

       [[ 11,  10,  10, ...,   4,   4,   4],
        [ 11,  10,  10, ...,   4,   4,   4],
        [ 11,  10,  10, ...,   4,   4,   4],
        ...,
        [  2,   2,   2, ...,   2,   2,   2],
        [  2,   2,   2, ...,   1,   2,   2],
        [  2,   2,   2, ...,   1,   2,   2]],

       [[  5,   6,   6, ...,   7,   8,   8],
        [  6,   6,   6, ...,   7,   9,   9],
        [  6,   6,   7, ...,   8,  11,  11],
        ...,
        [  5,   8,  25, ...,  55, 138,  39],
        [  5,   7,  22, ...,  20,  65,  34],
        [  5,   7,  22, ...,   6,   4,  27]],

       [[148, 150, 152, ...,  41,  39,  44],
        [133, 133, 132, ...,  41,  42,  40],
        [123, 123, 124, ...,  36,  40,  35],
        ...,
        [ 53,  53,  53, ...,  41,  43,  47],
        [ 54,  54,  53, ...,  35,  44,  51],
        [ 55,  57,  54, ...,  33,  43,  48]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_pixels_features_tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 240, 184)
</pre></div>
</div>
</div>
</div>
</section>
<section id="getting-pixels-features-tensor-for-color-images">
<h3><strong>Getting pixels features tensor for color images</strong><a class="headerlink" href="#getting-pixels-features-tensor-for-color-images" title="Link to this heading">#</a></h3>
<p>In this section we are going to use the  class <code class="docutils literal notranslate"><span class="pre">ImageTensorFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features tensors from data-sets of images, is based in the pixels method for features extraction, and allows both color and gray images, and different formats to deal with the color images.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageTensorFeaturesExtraction</span></code> will be applied on color images, using the data-set of images presented above.</p>
<ul class="simple">
<li><p><strong>Tensor of 2D arrays</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageTensorFeaturesExtraction</span><span class="p">(</span><span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color_dim</span><span class="o">=</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">color_pixels_features_tensor</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[ 23.,  28.,  21., ...,  52.,  64.,  54.],
        [ 18.,  23.,  17., ...,  39.,  51.,  38.],
        [ 18.,  23.,  17., ...,  38.,  49.,  34.],
        ...,
        [142., 143., 162., ..., 120., 111.,  71.],
        [125., 130., 142., ..., 120., 111.,  72.],
        [132., 136., 148., ..., 120., 111.,  72.]],

       [[ 43.,  48.,  26., ..., 226., 229., 236.],
        [ 41.,  46.,  24., ..., 243., 246., 251.],
        [ 60.,  65.,  43., ..., 236., 239., 244.],
        ...,
        [ 69.,  74.,  78., ..., 147., 154., 162.],
        [ 68.,  71.,  76., ..., 135., 152., 169.],
        [ 68.,  71.,  76., ..., 136., 152., 168.]],

       [[ 31.,  87.,  13., ..., 254., 250., 255.],
        [ 16.,  73.,   8., ..., 253., 251., 255.],
        [ 32.,  90.,  25., ..., 253., 251., 255.],
        ...,
        [ 90., 109., 113., ..., 100., 111., 115.],
        [ 91., 110., 114., ..., 105., 116., 120.],
        [ 94., 113., 117., ..., 110., 121., 125.]],

       ...,

       [[ 26.,   5.,   2., ...,  10.,   1.,   2.],
        [ 26.,   5.,   2., ...,  10.,   1.,   2.],
        [ 27.,   4.,   2., ...,  10.,   1.,   2.],
        ...,
        [  3.,   2.,   0., ...,   3.,   1.,   2.],
        [  3.,   2.,   0., ...,   3.,   1.,   2.],
        [  3.,   2.,   0., ...,   3.,   1.,   2.]],

       [[ 18.,   0.,   0., ...,  26.,   1.,   0.],
        [ 18.,   1.,   0., ...,  27.,   2.,   0.],
        [ 19.,   1.,   0., ...,  29.,   4.,   0.],
        ...,
        [ 16.,   0.,   2., ...,  52.,  35.,  24.],
        [ 16.,   0.,   5., ...,  48.,  30.,  20.],
        [ 15.,   0.,   8., ...,  41.,  22.,  14.]],

       [[105., 155., 224., ...,  36.,  48.,  45.],
        [ 90., 140., 209., ...,  32.,  44.,  42.],
        [ 80., 130., 199., ...,  28.,  38.,  36.],
        ...,
        [ 52.,  56.,  41., ...,  62.,  43.,  28.],
        [ 53.,  57.,  42., ...,  66.,  47.,  32.],
        [ 54.,  58.,  43., ...,  63.,  44.,  29.]]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 240, 552)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Tensor of 3D arrays</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageTensorFeaturesExtraction</span><span class="p">(</span><span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="n">convert_to_gray</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color_dim</span><span class="o">=</span><span class="s1">&#39;3D&#39;</span><span class="p">)</span>
<span class="n">color_pixels_features_tensor</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[[[ 23,  28,  21],
         [ 15,  22,  12],
         [ 25,  31,  19],
         ...,
         [ 68,  81,  60],
         [ 55,  67,  59],
         [ 52,  64,  54]],

        [[ 18,  23,  17],
         [ 45,  50,  43],
         [ 40,  46,  36],
         ...,
         [ 74,  87,  66],
         [ 46,  58,  45],
         [ 39,  51,  38]],

        [[ 18,  23,  17],
         [ 47,  51,  44],
         [ 44,  50,  40],
         ...,
         [ 85,  98,  78],
         [ 53,  64,  49],
         [ 38,  49,  34]],

        ...,

        [[142, 143, 162],
         [204, 205, 220],
         [203, 205, 214],
         ...,
         [129, 121,  82],
         [121, 112,  72],
         [120, 111,  71]],

        [[125, 130, 142],
         [181, 185, 197],
         [167, 174, 183],
         ...,
         [125, 117,  76],
         [121, 112,  73],
         [120, 111,  72]],

        [[132, 136, 148],
         [160, 163, 175],
         [165, 171, 180],
         ...,
         [125, 117,  76],
         [121, 112,  73],
         [120, 111,  72]]],


       [[[ 43,  48,  26],
         [ 94, 100,  80],
         [105, 114,  97],
         ...,
         [222, 225, 233],
         [230, 233, 240],
         [226, 229, 236]],

        [[ 41,  46,  24],
         [ 98, 105,  83],
         [125, 135, 118],
         ...,
         [217, 220, 228],
         [232, 235, 242],
         [243, 246, 251]],

        [[ 60,  65,  43],
         [ 75,  82,  60],
         [134, 144, 126],
         ...,
         [215, 218, 226],
         [238, 241, 249],
         [236, 239, 244]],

        ...,

        [[ 69,  74,  78],
         [ 66,  71,  75],
         [ 75,  81,  85],
         ...,
         [146, 152, 156],
         [147, 154, 162],
         [147, 154, 162]],

        [[ 68,  71,  76],
         [ 66,  69,  74],
         [ 74,  77,  82],
         ...,
         [143, 152, 166],
         [135, 152, 169],
         [135, 152, 169]],

        [[ 68,  71,  76],
         [ 66,  69,  74],
         [ 75,  78,  83],
         ...,
         [143, 152, 165],
         [136, 152, 168],
         [136, 152, 168]]],


       [[[ 31,  87,  13],
         [ 74, 126,  54],
         [ 50,  97,  27],
         ...,
         [253, 250, 250],
         [253, 250, 255],
         [254, 250, 255]],

        [[ 16,  73,   8],
         [ 42,  94,  23],
         [ 35,  82,  13],
         ...,
         [252, 251, 250],
         [252, 251, 255],
         [253, 251, 255]],

        [[ 32,  90,  25],
         [ 54, 107,  37],
         [ 60, 107,  39],
         ...,
         [252, 251, 248],
         [252, 251, 254],
         [253, 251, 255]],

        ...,

        [[ 90, 109, 113],
         [ 91, 110, 114],
         [ 88, 107, 111],
         ...,
         [ 95, 106, 110],
         [105, 116, 120],
         [100, 111, 115]],

        [[ 91, 110, 114],
         [ 94, 113, 117],
         [ 89, 108, 112],
         ...,
         [ 97, 108, 112],
         [114, 125, 129],
         [105, 116, 120]],

        [[ 94, 113, 117],
         [ 92, 111, 115],
         [ 88, 107, 111],
         ...,
         [101, 112, 116],
         [123, 134, 138],
         [110, 121, 125]]],


       ...,


       [[[ 26,   5,   2],
         [ 25,   4,   1],
         [ 25,   4,   1],
         ...,
         [ 12,   0,   0],
         [ 10,   1,   2],
         [ 10,   1,   2]],

        [[ 26,   5,   2],
         [ 25,   4,   1],
         [ 25,   4,   1],
         ...,
         [ 12,   0,   0],
         [ 10,   1,   2],
         [ 10,   1,   2]],

        [[ 27,   4,   2],
         [ 26,   3,   1],
         [ 26,   3,   1],
         ...,
         [ 12,   0,   0],
         [ 10,   1,   2],
         [ 10,   1,   2]],

        ...,

        [[  3,   2,   0],
         [  3,   2,   0],
         [  3,   2,   0],
         ...,
         [  3,   2,   0],
         [  3,   1,   2],
         [  3,   1,   2]],

        [[  3,   2,   0],
         [  3,   2,   0],
         [  3,   2,   0],
         ...,
         [  2,   1,   0],
         [  3,   1,   2],
         [  3,   1,   2]],

        [[  3,   2,   0],
         [  3,   2,   0],
         [  3,   2,   0],
         ...,
         [  2,   1,   0],
         [  3,   1,   2],
         [  3,   1,   2]]],


       [[[ 18,   0,   0],
         [ 19,   1,   0],
         [ 19,   1,   0],
         ...,
         [ 25,   0,   0],
         [ 26,   1,   0],
         [ 26,   1,   0]],

        [[ 18,   1,   0],
         [ 19,   1,   0],
         [ 19,   1,   0],
         ...,
         [ 25,   0,   0],
         [ 27,   2,   0],
         [ 27,   2,   0]],

        [[ 19,   1,   0],
         [ 19,   1,   0],
         [ 20,   2,   0],
         ...,
         [ 26,   1,   0],
         [ 29,   4,   0],
         [ 29,   4,   0]],

        ...,

        [[ 16,   0,   2],
         [ 26,   0,   0],
         [ 55,  14,   1],
         ...,
         [ 62,  53,  51],
         [147, 135, 129],
         [ 52,  35,  24]],

        [[ 16,   0,   5],
         [ 25,   0,   0],
         [ 53,  11,   1],
         ...,
         [ 27,  17,  17],
         [ 75,  62,  57],
         [ 48,  30,  20]],

        [[ 15,   0,   8],
         [ 24,   0,   1],
         [ 53,  10,   1],
         ...,
         [ 14,   2,   2],
         [ 13,   0,   0],
         [ 41,  22,  14]]],


       [[[105, 155, 224],
         [107, 157, 226],
         [109, 159, 228],
         ...,
         [ 36,  44,  41],
         [ 31,  43,  39],
         [ 36,  48,  45]],

        [[ 90, 140, 209],
         [ 90, 140, 209],
         [ 89, 139, 207],
         ...,
         [ 36,  43,  40],
         [ 35,  46,  41],
         [ 32,  44,  42]],

        [[ 80, 130, 199],
         [ 80, 130, 199],
         [ 81, 131, 199],
         ...,
         [ 33,  38,  36],
         [ 35,  43,  40],
         [ 28,  38,  36]],

        ...,

        [[ 52,  56,  41],
         [ 52,  56,  41],
         [ 52,  56,  40],
         ...,
         [ 56,  37,  21],
         [ 58,  39,  25],
         [ 62,  43,  28]],

        [[ 53,  57,  42],
         [ 53,  57,  42],
         [ 52,  56,  40],
         ...,
         [ 50,  31,  16],
         [ 59,  40,  25],
         [ 66,  47,  32]],

        [[ 54,  58,  43],
         [ 56,  60,  45],
         [ 53,  57,  41],
         ...,
         [ 48,  29,  14],
         [ 58,  39,  24],
         [ 63,  44,  29]]]], dtype=uint8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_pixels_features_tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 240, 184, 3)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="histogram-of-oriented-gradients-method">
<h2><strong>Histogram of Oriented Gradients Method</strong><a class="headerlink" href="#histogram-of-oriented-gradients-method" title="Link to this heading">#</a></h2>
<p>HOG (Histogram of Oriented Gradients) is a technique used for feature extraction in image processing and computer vision tasks like object detection and classification. It works by dividing an image into small regions, computes the gradient orientation within each region, and then builds a histogram of these gradients. The resulting feature vector represents the distribution of gradient orientations, capturing important information about the edges and textures present in the image. HOG is particularly effective for recognizing objects in images regardless of changes in lighting conditions and backgrounds, making it a popular choice in various applications such as pedestrian detection, face recognition, and surveillance.</p>
<p>A brief summary of how Histogram of Oriented Gradients (HOG) works as a feature extraction method for images:</p>
<ul class="simple">
<li><p><strong>Gradient Calculation:</strong> Compute the gradient (derivative) of pixel intensities in the image to capture local edge information. Typically, gradient magnitude and direction are computed using gradient filters like the Sobel operator.</p></li>
<li><p><strong>Cell Division:</strong> Divide the image into small, overlapping cells (e.g., 8x8 pixels). Each cell accumulates gradient information by constructing histograms of gradient orientations.</p></li>
<li><p><strong>Histograms of Oriented Gradients:</strong> Within each cell, construct histograms of gradient orientations to represent the distribution of edge directions. This captures local texture and shape information.</p></li>
<li><p><strong>Block Normalization:</strong> Group cells into larger blocks (e.g., 2x2 or 3x3 cells) to enhance local contrast and normalize illumination changes. Normalize the histograms within each block to make the descriptor invariant to changes in lighting and contrast.</p></li>
<li><p><strong>Descriptor Formation:</strong> Concatenate the normalized block features to form the final HOG descriptor for the image. This descriptor captures the local intensity gradients and their orientations across different regions of the image.</p></li>
<li><p><strong>Feature Vector Extraction:</strong> The HOG descriptor forms a feature vector representing the image. This feature vector can be used as input to machine learning algorithms for tasks such as object detection, classification, or similarity comparison.</p></li>
</ul>
<p>The method <code class="docutils literal notranslate"><span class="pre">hog</span></code> from the module <code class="docutils literal notranslate"><span class="pre">feature</span></code> of the <code class="docutils literal notranslate"><span class="pre">skimage</span></code> package provides a way to compute a Histogram of Oriented Gradients (HOG) by:</p>
<ul class="simple">
<li><p>Global image normalisation (optional)</p></li>
<li><p>Computing the gradient image in x and y</p></li>
<li><p>Computing gradient histograms</p></li>
<li><p>Normalising across blocks</p></li>
<li><p>Flattening into a feature vector</p></li>
</ul>
<p>HOG usually works on gray-scale images, so images should be converted to gray-scale before serving as input for this method.</p>
<p>Once we have the HOG feature vector for a given image we can proceed in several ways, specifically the following will be considered throughout this project:</p>
<ul class="simple">
<li><p>Consider the HOG features vector as the numerical representation of the image.</p>
<ul>
<li><p>This approach usually leads to a computational problem since the length of this vectors is usually massive, but this issue can be mitigated utilizing dimensionality reduction techniques, such as PCA.</p></li>
</ul>
</li>
<li><p>Transform the HOG features vector into a features matrix.</p>
<ul>
<li><p>Transform the features matrix in a new features vector by computing <strong>statistics</strong> along the matrix columns.</p></li>
<li><p>Transform the features matrix in a new features vector by computing the <strong>histogram of bags of visual words</strong> (BVW).</p></li>
</ul>
</li>
</ul>
<p>In order to understand better how HOG works we are going to apply it to several images, and plot the resulting HOG image along with the original one, to compare and extract valuable insight regarding this method just in a visual manner.</p>
<p>Here a classic example, provided in the <code class="docutils literal notranslate"><span class="pre">skimage</span></code> documentation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\fscielzo\Documents\DataScience-GitHub\Image Analysis\Image-Classification\Fire-Detection\images\HOG_1.webp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0271c2b90810ea64e31e90036ad12d9b0f457aaaa98f365c698fee341b07a15f.png" src="_images/0271c2b90810ea64e31e90036ad12d9b0f457aaaa98f365c698fee341b07a15f.png" />
</div>
</div>
<p>The next plot includes several images of our data-set together with its HOG representation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CELLS_PER_BLOCK_HOR</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">CELLS_PER_BLOCK_VER</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">PIXELS_PER_CELL_HOR</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">PIXELS_PER_CELL_VER</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">orientations</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pixels_per_cell</span><span class="o">=</span><span class="p">(</span><span class="n">PIXELS_PER_CELL_HOR</span><span class="p">,</span> <span class="n">PIXELS_PER_CELL_VER</span><span class="p">)</span>
<span class="n">cells_per_block</span><span class="o">=</span><span class="p">(</span><span class="n">CELLS_PER_BLOCK_HOR</span><span class="p">,</span> <span class="n">CELLS_PER_BLOCK_VER</span><span class="p">)</span>

<span class="n">n_images</span> <span class="o">=</span> <span class="mi">9</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">random_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">n_images</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">random_idx</span> <span class="o">=</span> <span class="n">random_idx</span> <span class="o">+</span> <span class="p">[</span><span class="mi">103</span><span class="p">]</span>
<span class="n">img_gray_array_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">random_idx</span><span class="p">]</span>
<span class="n">img_color_array_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">random_idx</span><span class="p">]</span>

<span class="n">HOG_visualize_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">img_array</span> <span class="ow">in</span> <span class="n">img_gray_array_list</span><span class="p">:</span>
    
    <span class="n">HOG_img</span><span class="p">,</span> <span class="n">HOG_visualize</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">hog</span><span class="p">(</span><span class="n">img_array</span><span class="p">,</span> <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span>
                <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span>
                <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span>
                <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">HOG_visualize_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HOG_visualize</span><span class="p">)</span>
    
<span class="n">n_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">img_color_array_list</span><span class="p">,</span> <span class="n">HOG_visualize_list</span><span class="p">)))</span>
<span class="n">subplot_idx</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_rows</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n_rows</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">40</span><span class="p">))</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> 

<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">img_color_array</span><span class="p">,</span> <span class="n">HOG_visualize</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">subplot_idx</span><span class="p">,</span> <span class="n">img_color_array_list</span><span class="p">,</span> <span class="n">HOG_visualize_list</span><span class="p">):</span>
    
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_color_array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">HOG_visualize</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original image&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;HOG image&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># Hide the axis</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.025</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/27589ba13a8da6d84969ec3b15c2e7ee972553bf907c7734058d2f1d57f3198c.png" src="_images/27589ba13a8da6d84969ec3b15c2e7ee972553bf907c7734058d2f1d57f3198c.png" />
</div>
</div>
<p>Now we are going to explore how are the outputs resulting of applying HOG on an image.</p>
<ul class="simple">
<li><p><strong>HOG features vector</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_gray_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">103</span><span class="p">])</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">))</span>

<span class="n">HOG_img</span><span class="p">,</span> <span class="n">HOG_visualize</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">hog</span><span class="p">(</span><span class="n">img_gray_array</span><span class="p">,</span> <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span>
                <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span>
                <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span>
                <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visualize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.36364343, 0.03360488, 0.02089678, ..., 0.03660126, 0.02114829,
       0.01176881])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(23232,)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>HOG feature matrix:</strong> reshaping the features vector into a matrix.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">orientations</span> <span class="o">*</span> <span class="n">cells_per_block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">cells_per_block</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># number of features</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">HOG_img</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">p</span><span class="p">)</span> <span class="c1"># length of the features</span>
<span class="n">HOG_img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">HOG_img</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.36364343, 0.03360488, 0.02089678, ..., 0.03471119, 0.04365133,
        0.        ],
       [0.47612765, 0.        , 0.        , ..., 0.0672579 , 0.12666173,
        0.        ],
       [0.38112443, 0.        , 0.07521982, ..., 0.        , 0.048066  ,
        0.        ],
       ...,
       [0.15979678, 0.0981024 , 0.16545619, ..., 0.14736083, 0.08917909,
        0.03633761],
       [0.04752936, 0.15648015, 0.12212673, ..., 0.11533974, 0.05735903,
        0.00558269],
       [0.25748894, 0.28158486, 0.11105426, ..., 0.03660126, 0.02114829,
        0.01176881]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(726, 32)
</pre></div>
</div>
</div>
</div>
<section id="based-on-statistics">
<h3><strong>Based on Statistics</strong><a class="headerlink" href="#based-on-statistics" title="Link to this heading">#</a></h3>
<p>Statistics aggregation can be used to transform the <code class="docutils literal notranslate"><span class="pre">HOG_img</span></code> matrix into a features vector that represent the given image. In other words, to extracts a features vector for a given images based on HOG.</p>
<p>In the next cells a couple of examples of how to do it are shown.</p>
<ul class="simple">
<li><p><strong>Statistics:</strong> <strong>mean</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">HOG_img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">HOG_img_mean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.14679672, 0.0803544 , 0.09536614, 0.1419433 , 0.21723404,
       0.08575819, 0.10150205, 0.08248819, 0.14743567, 0.08275199,
       0.09822818, 0.1462247 , 0.21792027, 0.08908326, 0.10341332,
       0.08480108, 0.15140446, 0.08353412, 0.09937754, 0.16057091,
       0.23059348, 0.09163763, 0.1043415 , 0.08710898, 0.15154042,
       0.08582017, 0.100348  , 0.16331974, 0.23107536, 0.09231949,
       0.10460763, 0.08779868])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img_mean</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(32,)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Statistics:</strong> <strong>mean-std</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">HOG_img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">HOG_img_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">HOG_img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">HOG_img_stats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">HOG_img_mean</span><span class="p">,</span> <span class="n">HOG_img_std</span><span class="p">])</span>
<span class="n">HOG_img_stats</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.14679672, 0.0803544 , 0.09536614, 0.1419433 , 0.21723404,
       0.08575819, 0.10150205, 0.08248819, 0.14743567, 0.08275199,
       0.09822818, 0.1462247 , 0.21792027, 0.08908326, 0.10341332,
       0.08480108, 0.15140446, 0.08353412, 0.09937754, 0.16057091,
       0.23059348, 0.09163763, 0.1043415 , 0.08710898, 0.15154042,
       0.08582017, 0.100348  , 0.16331974, 0.23107536, 0.09231949,
       0.10460763, 0.08779868, 0.1317824 , 0.09294007, 0.09738209,
       0.15405147, 0.13246163, 0.09432467, 0.110728  , 0.10418498,
       0.13221261, 0.09430074, 0.09785966, 0.15478669, 0.13196037,
       0.09770127, 0.11163924, 0.10598677, 0.134641  , 0.09318608,
       0.09613184, 0.1606208 , 0.13438775, 0.09621373, 0.11163673,
       0.10831574, 0.13312731, 0.09576936, 0.0957986 , 0.15947756,
       0.13395827, 0.09442077, 0.11003086, 0.10837857])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HOG_img_stats</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(64,)
</pre></div>
</div>
</div>
</div>
<section id="based-on-bags-of-visual-words-bvw">
<h4><strong>Based on Bags of Visual Words (BVW)</strong><a class="headerlink" href="#based-on-bags-of-visual-words-bvw" title="Link to this heading">#</a></h4>
<p>The following diagram explains how the BVW can be used to extract a features vector from an image based on HOG.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;C:\Users\fscielzo\Documents\DataScience-GitHub\Image Analysis\Image-Classification\Fire-Detection\images\HOG_2.jpg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/93a6f73804c4a732f070617c2fea51c8e624f8826f9f368c6a271e79ca2ea203.png" src="_images/93a6f73804c4a732f070617c2fea51c8e624f8826f9f368c6a271e79ca2ea203.png" />
</div>
</div>
</section>
</section>
</section>
<section id="hog-stats-features-matrix">
<h2><strong>HOG-stats features matrix</strong><a class="headerlink" href="#hog-stats-features-matrix" title="Link to this heading">#</a></h2>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> images <span class="math notranslate nohighlight">\(\mathcal{I}_1,\dots , \mathcal{I}_n\)</span> of the same size <span class="math notranslate nohighlight">\(h\times w\)</span>.</p>
<p>Using the <strong>HOG</strong> method for features extraction <strong>based on statistics</strong>, a <strong>features matrix</strong> for those images can be build as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X =   \begin{pmatrix} v(\mathcal{I}_1)  \\
                        v(\mathcal{I}_2)    \\
                        \dots  \\
                        v(\mathcal{I}_n) 
                        \end{pmatrix} \end{split}\]</div>
<p>Now <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)\)</span>  is the a vector of statistics computed by columns on the HOG features matrix <span class="math notranslate nohighlight">\(\mathcal{M}(\mathcal{I}_i)\)</span> (<code class="docutils literal notranslate"><span class="pre">HOG_img</span></code>) for the image <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span> <span class="math notranslate nohighlight">\(\hspace{0.1cm}\Rightarrow\hspace{0.1cm}\)</span> <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)= \)</span> <code class="docutils literal notranslate"><span class="pre">HOG_img_stats</span></code>.</p>
<p>This matrix is a 2D array of size <span class="math notranslate nohighlight">\(n\times p\)</span>  that contains the HOG statistics of each image.</p>
<blockquote>
<div><p>Extracting the vector <code class="docutils literal notranslate"><span class="pre">HOG_img_stats</span></code> for each image on the data-set and concatenating them by rows we obtain a HGO-stats features matrix.</p>
</div></blockquote>
<section id="getting-hgo-stats-features-matrix">
<h3><strong>Getting HGO-stats features matrix</strong><a class="headerlink" href="#getting-hgo-stats-features-matrix" title="Link to this heading">#</a></h3>
<p>In this section we are going to use the  class <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features matrices from data-sets of images, allowing different method for features extraction as well as different functionalities like working with both color and gray images, many filters, different formats and strategies for the different features extraction methods and so on.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> will be applied with the <strong>HOG</strong> method for feature extraction based on <strong>statistics</strong>, using the data-set of images presented above.</p>
<ul class="simple">
<li><p><strong>Statistics: mean</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">HGO_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.20157584, 0.14783572, 0.12745415, ..., 0.10648443, 0.13134968,
        0.18349608],
       [0.17286368, 0.14136847, 0.15825279, ..., 0.11890768, 0.11860601,
        0.1418163 ],
       [0.18598968, 0.15119294, 0.1556355 , ..., 0.12523065, 0.1435575 ,
        0.16787505],
       ...,
       [0.23156577, 0.10066881, 0.10889268, ..., 0.0777515 , 0.11607629,
        0.11501912],
       [0.25385873, 0.13853749, 0.08665303, ..., 0.09441686, 0.16071724,
        0.22178972],
       [0.19882647, 0.15653812, 0.14570778, ..., 0.12343722, 0.13397905,
        0.15106539]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 32)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Statistics: mean-Q25-median-Q75-std</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="s1">&#39;mean-Q25-median-Q75-std&#39;</span><span class="p">)</span>

<span class="n">HGO_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.20157584, 0.14783572, 0.12745415, ..., 0.07722948, 0.08753731,
        0.09752229],
       [0.17286368, 0.14136847, 0.15825279, ..., 0.08342822, 0.08358776,
        0.10379498],
       [0.18598968, 0.15119294, 0.1556355 , ..., 0.07379397, 0.08382094,
        0.09449716],
       ...,
       [0.23156577, 0.10066881, 0.10889268, ..., 0.08503151, 0.10009281,
        0.11873147],
       [0.25385873, 0.13853749, 0.08665303, ..., 0.08438005, 0.10134144,
        0.10840959],
       [0.19882647, 0.15653812, 0.14570778, ..., 0.08484173, 0.0841926 ,
        0.10205706]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 160)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Applying equalization</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;equalized&#39;</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">HGO_features_filtered_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_filtered_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.20078454, 0.14787799, 0.12604256, ..., 0.10548965, 0.13279582,
        0.18339162],
       [0.17293476, 0.14033908, 0.1537719 , ..., 0.11915944, 0.11854023,
        0.14170413],
       [0.18746046, 0.15079661, 0.14928058, ..., 0.12890023, 0.14689157,
        0.16894386],
       ...,
       [0.23320771, 0.08942915, 0.1014497 , ..., 0.07468827, 0.11502458,
        0.11756563],
       [0.25469751, 0.13832403, 0.08580414, ..., 0.09091659, 0.16319569,
        0.22209216],
       [0.19423289, 0.15211316, 0.14351524, ..., 0.12170027, 0.12920767,
        0.15031476]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_filtered_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 32)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Applying hessian filter</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;hessian&#39;</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>

<span class="n">HGO_features_filtered_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_filtered_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.21395189, 0.15094232, 0.13975573, ..., 0.12033038, 0.13637175,
        0.15742064],
       [0.18118397, 0.14117219, 0.14688905, ..., 0.11819649, 0.12805744,
        0.13398258],
       [0.1952499 , 0.16164455, 0.14418718, ..., 0.12276572, 0.14569308,
        0.15200626],
       ...,
       [0.1919733 , 0.11779311, 0.12347916, ..., 0.10288798, 0.10688693,
        0.16267898],
       [0.24987259, 0.10253705, 0.10691321, ..., 0.12632426, 0.11728681,
        0.20749636],
       [0.20363335, 0.14678954, 0.13949207, ..., 0.11866348, 0.1229296 ,
        0.14670206]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_filtered_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 32)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="hog-bvw-features-matrix">
<h2><strong>HOG-BVW features matrix</strong><a class="headerlink" href="#hog-bvw-features-matrix" title="Link to this heading">#</a></h2>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> images <span class="math notranslate nohighlight">\(\mathcal{I}_1,\dots , \mathcal{I}_n\)</span> of the same size <span class="math notranslate nohighlight">\(h\times w\)</span>.</p>
<p>Using the <strong>HOG</strong> method for features extraction <strong>based on BVW</strong>, a <strong>features matrix</strong> for those images can be build as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X =   \begin{pmatrix} v(\mathcal{I}_1)  \\
                        v(\mathcal{I}_2)    \\
                        \dots  \\
                        v(\mathcal{I}_n) 
                        \end{pmatrix} \end{split}\]</div>
<p>Now <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)\)</span> is the a vector of BVW frequencies for the image <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span>.</p>
<p>This matrix is a 2D array of size <span class="math notranslate nohighlight">\(n\times p\)</span>  that contains the BVW frequencies for each image.</p>
<blockquote>
<div><p>Extracting the vector of BVW frequencies for each image  on the data-set (like it is shown in the diagram) and concatenating them by rows we obtain a HGO-BVW features matrix.</p>
</div></blockquote>
<section id="getting-hgo-bvw-features-matrix">
<h3><strong>Getting HGO-BVW features matrix</strong><a class="headerlink" href="#getting-hgo-bvw-features-matrix" title="Link to this heading">#</a></h3>
<p>In this section we are going to use the  class <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features matrices from data-sets of images, allowing different method for features extraction as well as different functionalities like working with both color and gray images, many filters, different formats and strategies for the different features extraction methods and so on.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> will be applied with the <strong>HOG</strong> method for feature extraction based on <strong>BVW</strong>, using the data-set of images presented above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="s1">&#39;BVW&#39;</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">HGO_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fscielzo\anaconda3\Lib\site-packages\sklearn\cluster\_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3,  9,  7, ...,  3,  2, 15],
       [ 1,  5, 12, ...,  2,  0, 13],
       [ 5,  8, 20, ...,  0,  4, 40],
       ...,
       [ 3,  5, 13, ...,  1,  4, 14],
       [ 9, 19, 14, ...,  2,  3,  3],
       [10,  5,  7, ...,  6,  0, 10]], dtype=int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 100)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Filtering with sobel</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;sobel&#39;</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">statistics</span><span class="o">=</span><span class="s1">&#39;BVW&#39;</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">HGO_features_filtered_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fscielzo\anaconda3\Lib\site-packages\sklearn\cluster\_kmeans.py:1412: FutureWarning: The default value of `n_init` will change from 10 to &#39;auto&#39; in 1.4. Set the value of `n_init` explicitly to suppress the warning
  super()._check_params_vs_input(X, default_n_init=10)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_filtered_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 4,  5,  5, ...,  0,  7, 11],
       [ 3,  2, 15, ...,  0,  8,  2],
       [ 0,  2, 12, ...,  0, 10,  0],
       ...,
       [ 3,  8,  1, ..., 11,  6,  0],
       [ 0,  4,  0, ...,  0, 13, 14],
       [ 4,  2,  6, ...,  0,  1,  1]], dtype=int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_filtered_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 100)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="hog-not-reshaped-features-matrix">
<h2><strong>HOG - Not Reshaped features matrix</strong><a class="headerlink" href="#hog-not-reshaped-features-matrix" title="Link to this heading">#</a></h2>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> images <span class="math notranslate nohighlight">\(\mathcal{I}_1,\dots , \mathcal{I}_n\)</span> of the same size <span class="math notranslate nohighlight">\(h\times w\)</span>.</p>
<p>Using the <strong>HOG</strong> method for features extraction <strong>based on not reshaped HOG features</strong>, a <strong>features matrix</strong> for those images can be build as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X =   \begin{pmatrix} v(\mathcal{I}_1)  \\
                        v(\mathcal{I}_2)    \\
                        \dots  \\
                        v(\mathcal{I}_n) 
                        \end{pmatrix} \end{split}\]</div>
<p>Now <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)\)</span> is the a vector of HOG not reshaped features for the image <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span></p>
<p>This matrix is a 2D array of size <span class="math notranslate nohighlight">\(n\times p\)</span> that contains the not reshaped HOG features for each image.</p>
<blockquote>
<div><p>Extracting the not reshape HGO features for each image on the data-set and concatenating them by rows we obtain a HGO - not reshaped features matrix.</p>
</div></blockquote>
<ul class="simple">
<li><p>The <strong>problem</strong> of this approach is that leads to a <strong>dimensionality problem</strong> on <span class="math notranslate nohighlight">\(p\)</span>, so it needs to be applied along with <strong>dimensionality reduction</strong> techniques such as PCA.</p></li>
</ul>
<section id="getting-hgo-not-reshaped-features-matrix">
<h3><strong>Getting HGO - Not Reshaped features matrix</strong><a class="headerlink" href="#getting-hgo-not-reshaped-features-matrix" title="Link to this heading">#</a></h3>
<p>In this section we are going to use the  class <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features matrices from data-sets of images, allowing different method for features extraction as well as different functionalities like working with both color and gray images, many filters, different formats and strategies for the different features extraction methods and so on.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> will be applied with the <strong>HOG</strong> method for feature extraction based on <strong>not reshaping</strong>, using the data-set of images presented above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">HGO_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.23803907, 0.04517031, 0.11159217, ..., 0.13129353, 0.08770483,
        0.09647536],
       [0.24584797, 0.02077305, 0.0480539 , ..., 0.22148548, 0.13344476,
        0.09433893],
       [0.23915977, 0.23915977, 0.14695772, ..., 0.23245254, 0.23245254,
        0.11289806],
       ...,
       [0.45553614, 0.        , 0.        , ..., 0.        , 0.12639003,
        0.        ],
       [0.26050084, 0.28689935, 0.28689935, ..., 0.12227303, 0.11154988,
        0.27509187],
       [0.05024678, 0.00761688, 0.13056183, ..., 0.0925665 , 0.11715885,
        0.21169244]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 20416)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Filtering with sobel</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;HOG&#39;</span><span class="p">,</span> <span class="n">image_height</span><span class="o">=</span><span class="n">img_height</span><span class="p">,</span> <span class="n">image_width</span><span class="o">=</span><span class="n">img_width</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s1">&#39;sobel&#39;</span><span class="p">,</span> <span class="n">reshape</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                                 <span class="n">orientations</span><span class="o">=</span><span class="n">orientations</span><span class="p">,</span> <span class="n">pixels_per_cell</span><span class="o">=</span><span class="n">pixels_per_cell</span><span class="p">,</span> <span class="n">cells_per_block</span><span class="o">=</span><span class="n">cells_per_block</span><span class="p">,</span> 
                                                 <span class="n">transform_sqrt</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">HGO_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.16068715, 0.02210637, 0.08932776, ..., 0.21273152, 0.08234161,
        0.12393073],
       [0.22659834, 0.12988755, 0.04618949, ..., 0.24691583, 0.12855758,
        0.11606701],
       [0.22888939, 0.11324927, 0.22888939, ..., 0.2248361 , 0.2248361 ,
        0.17443813],
       ...,
       [0.41634108, 0.        , 0.        , ..., 0.        , 0.07710316,
        0.06034293],
       [0.29468638, 0.09417174, 0.02467003, ..., 0.21154874, 0.09705226,
        0.24505233],
       [0.07725128, 0.04226268, 0.05836576, ..., 0.11682897, 0.22934459,
        0.13684988]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HGO_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 20416)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="convolutional-neural-networks-method">
<h2><strong>Convolutional Neural Networks Method</strong><a class="headerlink" href="#convolutional-neural-networks-method" title="Link to this heading">#</a></h2>
<p>Using Convolutional Neural Networks (CNNs) for extracting image features offers several advantages:</p>
<ul class="simple">
<li><p><strong>Hierarchical Feature Learning:</strong> CNNs are designed to automatically learn hierarchical representations of features from raw input data. In the case of images, lower layers typically learn simple features like edges and textures, while higher layers learn more complex features like object parts and whole objects. By using a pre-trained CNN, you leverage the knowledge encoded in these learned features without having to manually engineer them.</p></li>
<li><p><strong>Transfer Learning:</strong> Pre-trained CNN models, such as VGG, ResNet, or Inception, have been trained on large-scale datasets like ImageNet for image classification tasks. These models have learned to recognize a wide variety of visual patterns and concepts. By using these pre-trained models as feature extractors, you can transfer this learned knowledge to new tasks or datasets with relatively little data. This is particularly useful when you have a small dataset or limited computational resources for training your own models from scratch.</p></li>
<li><p><strong>Dimensionality Reduction:</strong> The features extracted by CNNs typically reside in high-dimensional spaces, capturing rich information about the input images. These features can be used to represent images in a more compact and meaningful way compared to raw pixel values. This can be particularly beneficial for tasks such as image retrieval, where you want to efficiently compare images based on their visual content.</p></li>
<li><p><strong>Robustness to Variations:</strong> CNNs are designed to be robust to various transformations and distortions in the input images, such as changes in scale, rotation, illumination, and partial occlusion. The features learned by CNNs tend to capture invariant properties of objects, making them effective for tasks like object recognition and detection under different conditions.</p></li>
<li><p><strong>Interpretable Representations:</strong> The features learned by CNNs often correspond to semantically meaningful concepts in the images, such as object shapes, textures, or parts. This makes the extracted features more interpretable compared to handcrafted features, allowing for better understanding of the underlying characteristics of the data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load CNN model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">VGG16</span><span class="p">()</span>
<span class="c1"># Remove the output layer</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
<span class="c1"># Extracting the image height and width expected for the used CNN model.</span>
<span class="n">img_height_CNN</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">img_width_CNN</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Load an image from file</span>
<span class="n">img_path</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="mi">103</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">load_img</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="n">img_width_CNN</span><span class="p">,</span> <span class="n">img_height_CNN</span><span class="p">))</span>
<span class="c1"># Convert the image pixels to a numpy array</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">preprocessing</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">img_to_array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Reshape data for the model</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Prepare the image for the VGG model</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">preprocess_input</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Get CNN features</span>
<span class="n">CNN_features</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CNN_features</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.7327867, 0.       , 6.7262554, ..., 2.1139264, 5.3945417,
        0.       ]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CNN_features</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 4096)
</pre></div>
</div>
</div>
</div>
</section>
<section id="cnn-features-matrix">
<h2><strong>CNN features matrix</strong><a class="headerlink" href="#cnn-features-matrix" title="Link to this heading">#</a></h2>
<p>Given <span class="math notranslate nohighlight">\(n\)</span> images <span class="math notranslate nohighlight">\(\mathcal{I}_1,\dots , \mathcal{I}_n\)</span> of the same size <span class="math notranslate nohighlight">\(h\times w\)</span>.</p>
<p>Using the <strong>CNN</strong> method for features extraction, a <strong>features matrix</strong> for those images can be build as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}X =   \begin{pmatrix} v(\mathcal{I}_1)  \\
                        v(\mathcal{I}_2)    \\
                        \dots  \\
                        v(\mathcal{I}_n) 
                        \end{pmatrix} \end{split}\]</div>
<p>Now <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)\)</span> is a vector with the CNN features for the image <span class="math notranslate nohighlight">\(\mathcal{I}_i\)</span> <span class="math notranslate nohighlight">\(\hspace{0.1cm}\Rightarrow\hspace{0.1cm}\)</span> <span class="math notranslate nohighlight">\(v(\mathcal{I}_i)= \)</span> <code class="docutils literal notranslate"><span class="pre">CNN_features</span></code>.</p>
<p>This matrix is a 2D array of size <span class="math notranslate nohighlight">\(n\times p\)</span>  that contains the CNN features of each image.</p>
<blockquote>
<div><p>Extracting the vector <code class="docutils literal notranslate"><span class="pre">CNN_features</span></code> for each image  on the data-set and concatenating them by rows we obtain a CNN features matrix.</p>
</div></blockquote>
<section id="getting-cnn-features-matrix">
<h3><strong>Getting CNN features matrix</strong><a class="headerlink" href="#getting-cnn-features-matrix" title="Link to this heading">#</a></h3>
<p>In this section we are going to use the  class <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> from the <code class="docutils literal notranslate"><span class="pre">PyImageML</span></code> package , which has been developed to extract features matrices from data-sets of images, allowing different method for features extraction as well as different functionalities like working with both color and gray images, many filters, different formats and strategies for the different features extraction methods and so on.</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">ImageFeaturesExtraction</span></code> will be applied with the <strong>CNN</strong> method for feature extraction, using the data-set of images presented above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_feature_extraction</span> <span class="o">=</span> <span class="n">ImageFeaturesExtraction</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;CNN&#39;</span><span class="p">)</span>

<span class="n">CNN_features_matrix</span> <span class="o">=</span> <span class="n">img_feature_extraction</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CNN_features_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.39077538, 0.        , 0.        , ..., 0.        , 0.        ,
        0.        ],
       [0.        , 2.8053548 , 1.1582053 , ..., 0.        , 3.9529238 ,
        0.13838303],
       [0.        , 1.5708483 , 0.9057204 , ..., 0.        , 1.3198075 ,
        0.67053926],
       ...,
       [0.31342962, 0.04839906, 2.9200916 , ..., 2.756431  , 0.48978698,
        0.223643  ],
       [0.        , 0.        , 3.3499594 , ..., 0.        , 2.0666275 ,
        0.        ],
       [0.        , 0.8232522 , 0.51099145, ..., 5.909257  , 5.0205564 ,
        0.        ]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CNN_features_matrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300, 4096)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Filtering_images.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Filtering Images</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Inner_evaluation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Applying inner evaluation</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#requirements"><strong>Requirements</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-the-data"><strong>Reading the data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-response-and-predictors"><strong>Defining Response and Predictors</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-method"><strong>Pixel Method</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-pixel-features-from-gray-scale-image"><strong>Extracting pixel features from gray-scale image</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extracting-pixel-features-from-color-image"><strong>Extracting pixel features from color image</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pixel-features-array"><strong>Pixel features array</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-data-features-tensor"><strong>Sequential data: features tensor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabular-data-features-matrix"><strong>Tabular data: features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorial-representation-of-an-image"><strong>Vectorial representation of an image</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-matrix-for-gray-scale-images"><strong>Getting pixels features matrix for gray-scale images</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-matrix-for-color-images"><strong>Getting pixels features matrix for color images</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-tensor-for-gray-scale-images"><strong>Getting pixels features tensor for gray-scale images</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pixels-features-tensor-for-color-images"><strong>Getting pixels features tensor for color images</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#histogram-of-oriented-gradients-method"><strong>Histogram of Oriented Gradients Method</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#based-on-statistics"><strong>Based on Statistics</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#based-on-bags-of-visual-words-bvw"><strong>Based on Bags of Visual Words (BVW)</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hog-stats-features-matrix"><strong>HOG-stats features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-hgo-stats-features-matrix"><strong>Getting HGO-stats features matrix</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hog-bvw-features-matrix"><strong>HOG-BVW features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-hgo-bvw-features-matrix"><strong>Getting HGO-BVW features matrix</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hog-not-reshaped-features-matrix"><strong>HOG - Not Reshaped features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-hgo-not-reshaped-features-matrix"><strong>Getting HGO - Not Reshaped features matrix</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convolutional-neural-networks-method"><strong>Convolutional Neural Networks Method</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cnn-features-matrix"><strong>CNN features matrix</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-cnn-features-matrix"><strong>Getting CNN features matrix</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Fabio Scielzo Ortiz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>